Expedition=window.Expedition=window.$=function(a){return new Expedition.fn.init(a)};Expedition.canvas=Expedition.canvas||{};Expedition.canvas._event=[];Expedition.fn={init:function(a){if(a){this.id=a;if(a in Expedition.canvas){}else{Expedition.canvas[a]=this;Expedition.canvas[a]._event=[];Expedition.canvas[a]._canvas=Expedition.canvas._canvas;Expedition.fn.paint._newCanvas(a)}return Expedition.canvas[a]}return this},dispose:function(){var a=this.id;if(a in Expedition.canvas){$(a).cancelMove();$(a).hide();setTimeout(function(){var c=Expedition.canvas[a]._loop,f=Expedition.canvas[a]._otherLoop;if(c){for(var d=0;d<c.length;d++){if(c[d].loop){clearInterval(c[d].loop)}}}if(f){for(k in f){if(f[k]){clearInterval(f[k])}}}if($().g("canvasId"+a)){Expedition.fn.dom.remove("canvasId"+a)}Expedition.fn._lib.array.remove(Expedition.canvas._event,function(g){return g.id==a});if(a in Expedition.canvas){delete Expedition.canvas[a]}},50)}},show:function(){var c=this.id,a=Expedition.fn.paint._getNewCanvas(this.id);if(c){Expedition.canvas[c]._loop=Expedition.canvas[c]._loop||[];if(Expedition.canvas[c]._loop.length>0){a=$().g(Expedition.canvas[c]._loop[Expedition.canvas[c]._loop.length-1].id);if(a){$().setStyle(a,"display","block")}}else{if(a){$().setStyle(a,"display","block")}}Expedition.canvas[c].isHide=false}return this},hide:function(){var c=this.id,a=Expedition.fn.paint._getNewCanvas(this.id);if(c){Expedition.canvas[c]._loop=Expedition.canvas[c]._loop||[];if(Expedition.canvas[c]._loop.length>0){a=$().g(Expedition.canvas[c]._loop[Expedition.canvas[c]._loop.length-1].id);if(a){$().setStyle(a,"display","none")}}else{if(a){$().setStyle(a,"display","none")}}Expedition.canvas[c].isHide=true}return this}};Expedition.fn._browser=Expedition.fn._browser||{};Expedition.fn._browser.getBrowser=function(){return{isGecko:Expedition.fn._browser.isGecko||false,isStrict:Expedition.fn._browser.isStrict||false,safari:Expedition.fn._browser.safari||false,opera:Expedition.fn._browser.opera||false,chrome:Expedition.fn._browser.chrome||false,ie:Expedition.fn._browser.ie||false,maxthon:Expedition.fn._browser.maxthon||false,isWebkit:Expedition.fn._browser.isWebkit||false,firefox:Expedition.fn._browser.firefox||false,isCanvasSupport:Expedition.fn.isCanvasSupport()}};Expedition.fn.browser=Expedition.fn._browser.getBrowser;Expedition.fn.isGecko=function(){return Expedition.fn._browser.isGecko};Expedition.fn.isStrict=function(){return Expedition.fn._browser.isStrict};Expedition.fn.safari=function(){return Expedition.fn._browser.safari};Expedition.fn.opera=function(){return Expedition.fn._browser.opera};Expedition.fn.chrome=function(){return Expedition.fn._browser.chrome};Expedition.fn.ie=function(){return Expedition.fn._browser.ie};Expedition.fn.maxthon=function(){return Expedition.fn._browser.maxthon};Expedition.fn.isWebkit=function(){return Expedition.fn._browser.isWebkit};Expedition.fn.firefox=function(){return Expedition.fn._browser.firefox};Expedition.fn._browser.isCanvasSupport=function(){if(Expedition.fn._browser.ie>=9){return true}if(Expedition.fn._browser.chrome>=1){return true}if(Expedition.fn._browser.firefox>=1.5){return true}if(Expedition.fn._browser.opera>=9){return true}if(Expedition.fn._browser.safari>=1.3){return true}return false};Expedition.fn._browser.isGecko=/gecko/i.test(navigator.userAgent)&&!/like gecko/i.test(navigator.userAgent);Expedition.fn._browser.isStrict=document.compatMode=="CSS1Compat";if((/(\d+\.\d)(\.\d)?\s+safari/i.test(navigator.userAgent)&&!/chrome/i.test(navigator.userAgent))){Expedition.fn._browser.safari=parseFloat(RegExp["\x241"])}if(/opera\/(\d+\.\d)/i.test(navigator.userAgent)){Expedition.fn._browser.opera=parseFloat(RegExp["\x241"])}if(/chrome\/(\d+\.\d)/i.test(navigator.userAgent)){Expedition.fn._browser.chrome=parseFloat(RegExp["\x241"])}if(/msie (\d+\.\d)/i.test(navigator.userAgent)){Expedition.fn._browser.ie=document.documentMode||parseFloat(RegExp["\x241"])}try{if(/(\d+\.\d)/.test(external.max_version)){Expedition.fn._browser.maxthon=parseFloat(RegExp["\x241"])}}catch(e){}Expedition.fn._browser.isWebkit=/webkit/i.test(navigator.userAgent);if(/firefox\/(\d+\.\d)/i.test(navigator.userAgent)){Expedition.fn._browser.firefox=parseFloat(RegExp["\x241"])}Expedition.fn.dom=Expedition.fn.dom||{};Expedition.fn.dom._styleFilter=Expedition.fn.dom._styleFilter||[];Expedition.fn.dom._styleFilter[Expedition.fn.dom._styleFilter.length]={get:function(d,f){if(/color/i.test(d)&&f.indexOf("rgb(")!=-1){var g=f.split(",");f="#";for(var c=0,a;a=g[c];c++){a=parseInt(a.replace(/[^\d]/gi,""),10).toString(16);if(a.length==1){f+="0"+a}else{f+=a}}f=f.toUpperCase()}return f}};Expedition.fn.dom._styleFilter.filter=function(c,g,h){var f=Expedition.fn.dom._styleFilter,d;for(var a=0;d=f[a];a++){if(d=d[h]){g=d(c,g)}}return g};Expedition.fn.dom._styleFilter[Expedition.fn.dom._styleFilter.length]={set:function(a,c){if(c.constructor==Number&&!/zIndex|fontWeight|opacity|zoom|lineHeight/i.test(a)){c=c+"px"}return c}};Expedition.fn.dom._styleFixer=Expedition.fn.dom._styleFixer||{};Expedition.fn.dom._styleFixer.display=Expedition.fn.browser.ie&&Expedition.fn.browser.ie<8?{set:function(a,c){a=a.style;if(c=="inline-block"){a.display="inline";a.zoom=1}else{a.display=c}}}:Expedition.fn.browser.firefox&&Expedition.fn.browser.firefox<3?{set:function(a,c){a.style.display=c=="inline-block"?"-moz-inline-box":c}}:null;Expedition.fn.dom._styleFixer["float"]=Expedition.fn.browser.ie?"styleFloat":"cssFloat";Expedition.fn.dom._styleFixer.opacity=Expedition.fn.browser.ie?{get:function(a){var c=a.style.filter;c&&c.indexOf("opacity=")>=0?(parseFloat(c.match(/opacity=([^)]*)/)[1])/100)+"":"1"},set:function(a,d){var c=a.style;c.filter=(c.filter||"").replace(/alpha\([^\)]*\)/gi,"")+(d==1?"":"alpha(opacity="+d*100+")");c.zoom=1}}:null;Expedition.fn.dom._styleFixer.textOverflow=(function(){var c={};function a(g){var h=g.length;if(h>0){h=g[h-1];g.length--}else{h=null}return h}function d(g,h){g[Expedition.fn.browser.firefox?"textContent":"innerText"]=h}function f(r,l,v){var n=Expedition.fn.browser.ie?r.currentStyle||r.style:getComputedStyle(r,null),u=n.fontWeight,t="font-family:"+n.fontFamily+";font-size:"+n.fontSize+";word-spacing:"+n.wordSpacing+";font-weight:"+((parseInt(u)||0)==401?700:u)+";font-style:"+n.fontStyle+";font-variant:"+n.fontVariant,g=c[t];if(!g){n=r.appendChild(document.createElement("div"));n.style.cssText="float:left;"+t;g=c[t]=[];for(q=0;q<256;q++){q==32?(n.innerHTML="&nbsp;"):d(n,String.fromCharCode(q));g[q]=n.offsetWidth}d(n,"一");g[256]=n.offsetWidth;d(n,"一一");g[257]=n.offsetWidth-g[256]*2;g[258]=g[".".charCodeAt(0)]*3+g[257]*3;r.removeChild(n)}for(var p=r.firstChild,s=g[256],j=g[257],h=g[258],x=[],v=v?h:0;p;p=p.nextSibling){if(l<v){r.removeChild(p)}else{if(p.nodeType==3){for(var q=0,w=p.nodeValue,m=w.length;q<m;q++){n=w.charCodeAt(q);x[x.length]=[l,p,q];l-=(q?j:0)+(n<256?g[n]:s);if(l<v){break}}}else{n=p.tagName;if(n=="IMG"||n=="TABLE"){n=p;p=p.previousSibling;r.removeChild(n)}else{x[x.length]=[l,p];l-=p.offsetWidth}}}}if(l<v){while(n=a(x)){l=n[0];p=n[1];n=n[2];if(p.nodeType==3){if(l>=h){p.nodeValue=p.nodeValue.substring(0,n)+"...";return true}else{if(!n){r.removeChild(p)}}}else{if(f(p,l,true)){return true}else{r.removeChild(p)}}}r.innerHTML=""}}return{get:function(h,j){var g=Expedition.fn.browser;return(g.opera?j.OTextOverflow:g.firefox?h._baiduOverflow:j.textOverflow)||"clip"},set:function(h,l){var g=Expedition.fn.browser;if(h.tagName=="TD"||h.tagName=="TH"||g.firefox){h._baiduHTML&&(h.innerHTML=h._baiduHTML);if(l=="ellipsis"){h._baiduHTML=h.innerHTML;var m=document.createElement("div"),j=h.appendChild(m).offsetWidth;h.removeChild(m);f(h,j)}else{h._baiduHTML=""}}m=h.style;g.opera?(m.OTextOverflow=l):g.firefox?(h._baiduOverflow=l):(m.textOverflow=l)}}})();Expedition.fn.dom.g=function(a){if("string"==typeof a||a instanceof String){return document.getElementById(a)}else{if(a&&a.nodeName&&(a.nodeType==1||a.nodeType==9)){return a}}return null};Expedition.fn.g=Expedition.fn.G=Expedition.fn.dom.g;Expedition.fn.dom._NAME_ATTRS=(function(){var a={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",usemap:"useMap",frameborder:"frameBorder"};if(Expedition.fn.browser.ie<8){a["for"]="htmlFor";a["class"]="className"}else{a.htmlFor="for";a.className="class"}return a})();Expedition.fn.dom.setAttr=function(c,a,d){c=Expedition.fn.dom.g(c);if("style"==a){c.style.cssText=d}else{a=Expedition.fn.dom._NAME_ATTRS[a]||a;c.setAttribute(a,d)}return c};Expedition.fn.setAttr=Expedition.fn.dom.setAttr;Expedition.fn.dom.setAttrs=function(d,a){d=Expedition.fn.dom.g(d);for(var c in a){Expedition.fn.dom.setAttr(d,c,a[c])}return d};Expedition.fn.setAttrs=Expedition.fn.dom.setAttrs;Expedition.fn.dom.getAttr=function(c,a){c=Expedition.fn.dom.g(c);if("style"==a){return c.style.cssText}a=Expedition.fn.dom._NAME_ATTRS[a]||a;return c.getAttribute(a)};Expedition.fn.getAttr=Expedition.fn.dom.getAttr;Expedition.fn.dom._matchNode=function(a,d,f){a=Expedition.fn.dom.g(a);for(var c=a[f];c;c=c[d]){if(c.nodeType==1){return c}}return null};Expedition.fn.dom.prev=function(a){return Expedition.fn.dom._matchNode(a,"previousSibling","previousSibling")};Expedition.fn.string=Expedition.fn.string||{};(function(){var a=new RegExp("(^[\\s\\t\\xa0\\u3000]+)|([\\u3000\\xa0\\s\\t]+\x24)","g");Expedition.fn.string.trim=function(c){return String(c).replace(a,"")}})();Expedition.fn.trim=Expedition.fn.string.trim;Expedition.fn.dom.addClass=function(f,g){f=Expedition.fn.dom.g(f);var c=Expedition.fn.string.trim,d=c(g).split(/\s+/),a=d.length;g=f.className.split(/\s+/).join(" ");while(a--){(new RegExp("(^| )"+d[a]+"( |\x24)")).test(g)&&d.splice(a,1)}f.className=c(g+" "+d.join(" "));return f};Expedition.fn.addClass=Expedition.fn.dom.addClass;Expedition.fn.dom.hasClass=function(d,f){d=Expedition.fn.dom.g(d);var c=Expedition.fn.string.trim(f).split(/\s+/),a=c.length;f=d.className.split(/\s+/).join(" ");while(a--){if(!(new RegExp("(^| )"+c[a]+"( |\x24)")).test(f)){return false}}return true};Expedition.fn.dom.contains=function(a,c){var d=Expedition.fn.dom.g;a=d(a);c=d(c);return a.contains?a!=c&&a.contains(c):!!(a.compareDocumentPosition(c)&16)};Expedition.fn.dom.getDocument=function(a){a=Expedition.fn.dom.g(a);return a.nodeType==9?a:a.ownerDocument||a.document};Expedition.fn.dom.removeClass=function(c,d){c=Expedition.fn.dom.g(c);var a=Expedition.fn.string.trim;c.className=a(c.className.split(/\s+/).join("  ").replace(new RegExp("(^| )("+a(d).split(/\s+/).join("|")+")( |\x24)","g")," ").replace(/\s+/g," "));return c};Expedition.fn.removeClass=Expedition.fn.dom.removeClass;Expedition.fn.dom.children=function(c){c=Expedition.fn.dom.g(c);for(var a=[],d=c.firstChild;d;d=d.nextSibling){if(d.nodeType==1){a.push(d)}}return a};Expedition.fn.string.toCamelCase=function(a){if(a.indexOf("-")<0&&a.indexOf("_")<0){return a}return a.replace(/[-_][^-_]/g,function(c){return c.charAt(1).toUpperCase()})};Expedition.fn.dom.setStyle=function(d,c,f){var g=Expedition.fn.dom,a;d=g.g(d);c=Expedition.fn.string.toCamelCase(c);if(a=g._styleFilter){f=a.filter(c,f,"set")}a=g._styleFixer[c];(a&&a.set)?a.set(d,f):(d.style[a||c]=f);return d};Expedition.fn.setStyle=Expedition.fn.dom.setStyle;Expedition.fn.dom.setStyles=function(c,d){c=Expedition.fn.dom.g(c);for(var a in d){Expedition.fn.dom.setStyle(c,a,d[a])}return c};Expedition.fn.setStyles=Expedition.fn.dom.setStyles;Expedition.fn.dom.q=function(l,g,c){var m=[],f=Expedition.fn.string.trim,j,h,a,d;if(!(l=f(l))){return null}if("undefined"==typeof g){g=document}else{g=Expedition.fn.dom.g(g);if(!g){return m}}c&&(c=f(c).toUpperCase());if(g.getElementsByClassName){a=g.getElementsByClassName(l);j=a.length;for(h=0;h<j;h++){d=a[h];if(c&&d.tagName!=c){continue}m[m.length]=d}}else{l=new RegExp("(^|\\s)"+Expedition.fn.string.escapeReg(l)+"(\\s|\x24)");a=c?g.getElementsByTagName(c):(g.all||g.getElementsByTagName("*"));j=a.length;for(h=0;h<j;h++){d=a[h];l.test(d.className)&&(m[m.length]=d)}}return m};Expedition.fn.q=Expedition.fn.Q=Expedition.fn.dom.q;Expedition.fn.dom.getStyle=function(d,c){var h=Expedition.fn.dom;d=h.g(d);c=Expedition.fn.string.toCamelCase(c);var g=d.style[c];if(!g){var a=h._styleFixer[c],f=d.currentStyle||(Expedition.fn.browser.ie?d.style:getComputedStyle(d,null));if("string"==typeof a){g=f[a]}else{if(a&&a.get){g=a.get(d,f)}else{g=f[c]}}}if(a=h._styleFilter){g=a.filter(c,g,"get")}return g};Expedition.fn.getStyle=Expedition.fn.dom.getStyle;Expedition.fn.dom.getPosition=function(d){var o=Expedition.fn.dom.getDocument(d),h=Expedition.fn.browser,l=Expedition.fn.dom.getStyle;d=Expedition.fn.dom.g(d);var g=h.isGecko>0&&o.getBoxObjectFor&&l(d,"position")=="absolute"&&(d.style.top===""||d.style.left==="");var m={left:0,top:0};var j=(h.ie&&!h.isStrict)?o.body:o.documentElement;if(d==j){return m}var p=null;var f,n,c,q;if(d.getBoundingClientRect){f=d.getBoundingClientRect();m.left=Math.floor(f.left)+Math.max(o.documentElement.scrollLeft,o.body.scrollLeft);m.top=Math.floor(f.top)+Math.max(o.documentElement.scrollTop,o.body.scrollTop);m.left-=o.documentElement.clientLeft;m.top-=o.documentElement.clientTop;n=o.body;c=parseInt(l(n,"border-left-width"));q=parseInt(l(n,"border-top-width"));if(h.ie&&!h.isStrict){m.left-=isNaN(c)?2:c;m.top-=isNaN(q)?2:q}}else{if(o.getBoxObjectFor&&!g){f=o.getBoxObjectFor(d);var a=o.getBoxObjectFor(j);m.left=f.screenX-a.screenX;m.top=f.screenY-a.screenY}else{p=d;do{m.left+=p.offsetLeft;m.top+=p.offsetTop;if(h.isWebkit>0&&l(p,"position")=="fixed"){m.left+=o.body.scrollLeft;m.top+=o.body.scrollTop;break}p=p.offsetParent}while(p&&p!=d);if(h.opera>0||(h.isWebkit>0&&l(d,"position")=="absolute")){m.top-=o.body.offsetTop}p=d.offsetParent;while(p&&p!=o.body){m.left-=p.scrollLeft;if(!b.opera||p.tagName!="TR"){m.top-=p.scrollTop}p=p.offsetParent}}}return m};Expedition.fn.dom.intersect=function(m,l){var j=Expedition.fn.dom.g,h=Expedition.fn.dom.getPosition,a=Math.max,d=Math.min;m=j(m);l=j(l);var f=h(m),c=h(l);return a(f.left,c.left)<=d(f.left+m.offsetWidth,c.left+l.offsetWidth)&&a(f.top,c.top)<=d(f.top+m.offsetHeight,c.top+l.offsetHeight)};Expedition.fn.dom.last=function(a){return Expedition.fn.dom._matchNode(a,"previousSibling","lastChild")};Expedition.fn.dom.ready=function(){var d=false,g=false,f=[];function a(){if(!d){d=true;for(var l=0,h=f.length;l<h;l++){f[l]()}}}function c(){if(g){return}g=true;var m=document,j=window,h=Expedition.fn.browser.opera;if(m.addEventListener&&!h){m.addEventListener("DOMContentLoaded",h?function(){if(d){return}for(var n=0;n<m.styleSheets.length;n++){if(m.styleSheets[n].disabled){setTimeout(arguments.callee,0);return}}a()}:a,false)}else{if(Expedition.fn.browser.ie&&j==top){(function(){if(d){return}try{m.documentElement.doScroll("left")}catch(n){setTimeout(arguments.callee,0);return}a()})()}else{if(Expedition.fn.browser.safari){var l;(function(){if(d){return}if(m.readyState!="loaded"&&m.readyState!="complete"){setTimeout(arguments.callee,0);return}if(l===undefined){l=0;var q=m.getElementsByTagName("style");var o=m.getElementsByTagName("link");if(q){l+=q.length}if(o){for(var p=0,n=o.length;p<n;p++){if(o[p].getAttribute("rel")=="stylesheet"){l++}}}}if(m.styleSheets.length!=l){setTimeout(arguments.callee,0);return}a()})()}}}j.attachEvent?j.attachEvent("onload",a):j.addEventListener("load",a,false)}return function(h){c();d?h():(f[f.length]=h)}}();Expedition.fn.dom.getAncestorByTag=function(c,a){c=Expedition.fn.dom.g(c);a=a.toUpperCase();while((c=c.parentNode)&&c.nodeType==1){if(c.tagName==a){return c}}return null};Expedition.fn.dom.getWindow=function(a){a=Expedition.fn.dom.g(a);var c=Expedition.fn.dom.getDocument(a);return c.parentWindow||c.defaultView||null};Expedition.fn.dom.getAncestorBy=function(a,c){a=Expedition.fn.dom.g(a);while((a=a.parentNode)&&a.nodeType==1){if(c(a)){return a}}return null};Expedition.fn.dom.hide=function(a){a=Expedition.fn.dom.g(a);a.style.display="none";return a};Expedition.fn.dom.next=function(a){return Expedition.fn.dom._matchNode(a,"nextSibling","nextSibling")};Expedition.fn.dom.show=function(a){a=Expedition.fn.dom.g(a);a.style.display="";return a};Expedition.fn.dom.toggle=function(a){a=Expedition.fn.dom.g(a);a.style.display=a.style.display=="none"?"":"none";return a};Expedition.fn.dom._g=function(a){if("string"==typeof a||a instanceof String){return document.getElementById(a)}return a};Expedition.fn._g=Expedition.fn.dom._g;Expedition.fn.dom.insertAfter=function(f,d){var c,a;c=Expedition.fn.dom._g;f=c(f);d=c(d);a=d.parentNode;if(a){a.insertBefore(f,d.nextSibling)}return f};Expedition.fn.dom.first=function(a){return Expedition.fn.dom._matchNode(a,"nextSibling","firstChild")};Expedition.fn.dom.insertBefore=function(f,d){var c,a;c=Expedition.fn.dom._g;f=c(f);d=c(d);a=d.parentNode;if(a){a.insertBefore(f,d)}return f};Expedition.fn.dom.insertHTML=function(g,a,f){g=Expedition.fn.dom.g(g);if(g.insertAdjacentHTML){g.insertAdjacentHTML(a,f)}else{var c=g.ownerDocument.createRange();c.setStartBefore(g);var d=c.createContextualFragment(f),j=g.parentNode,h;switch(a.toUpperCase()){case"BEFOREBEGIN":j.insertBefore(d,g);break;case"AFTERBEGIN":g.insertBefore(d,g.firstChild);break;case"BEFOREEND":g.appendChild(d);break;case"AFTEREND":(h=g.nextSibling)?j.insertBefore(d,h):j.appendChild(d)}}return g};Expedition.fn.insertHTML=Expedition.fn.dom.insertHTML;Expedition.fn.dom.remove=function(a){a=Expedition.fn.dom.g(a);(tmpEl=a.parentNode)&&tmpEl.removeChild(a)};Expedition.fn.dom.getAncestorByClass=function(a,c){a=Expedition.fn.dom.g(a);c=new RegExp("(^|\\s)"+Expedition.fn.string.trim(c)+"(\\s|\x24)");while((a=a.parentNode)&&a.nodeType==1){if(c.test(a.className)){return a}}return null};Expedition.fn._lib=Expedition.fn._lib||{};Expedition.fn._lib._makeLine=function(g,j,f,h){var d=0,c=0;if(g===f){return{a:g,b:0}}else{d=(j-h+0)/(g-f);c=j-d*g;return{a:d,b:c}}};Expedition.fn._lib._findPoint=function(d,g,c,f){var a=0,h=0;if(d===c){return false}else{a=(f-g+0)/(d-c);h=d*a+g;return{x:a,y:h}}};Expedition.fn._lib._judgePoint=function(d,g,f,c){return g-(f*d+c)};Expedition.fn.object=Expedition.fn.object||{};Expedition.fn.object.extend=function(d,a){for(var c in a){if(a.hasOwnProperty(c)){d[c]=a[c]}}return d};Expedition.fn.extend=Expedition.fn.object.extend;Expedition.fn.object.each=function(g,d){var c,a,f;if("function"==typeof d){for(a in g){if(g.hasOwnProperty(a)){f=g[a];c=d.call(g,f,a);if(c===false){break}}}}return g};Expedition.fn.object.keys=function(f){var a=[],d=0,c;for(c in f){if(f.hasOwnProperty(c)){a[d++]=c}}return a};Expedition.fn.object.values=function(f){var a=[],d=0,c;for(c in f){if(f.hasOwnProperty(c)){a[d++]=f[c]}}return a};Expedition.fn.object.clone=(function(a){return function(h){var d=h,f,c;if(!h||h instanceof Number||h instanceof String||h instanceof Boolean){return d}else{if(h instanceof Array){d=[];var g=0;for(f=0,c=h.length;f<c;f++){d[g++]=Expedition.fn.object.clone(h[f])}}else{if("object"==typeof h){if(a[Object.prototype.toString.call(h)]){return d}d={};for(f in h){if(h.hasOwnProperty(f)){d[f]=Expedition.fn.object.clone(h[f])}}}}}return d}})({"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1});Expedition.fn._lib.vector=Expedition.fn._lib.vector||{};Expedition.fn._lib.vector.rotate=function(a,f,d){var d=Expedition.fn._lib.rad(d),c=Math.cos(d)*a-Math.sin(d)*f;y1=Math.sin(d)*a+Math.cos(d)*f;return{x:c,y:y1}};Expedition.fn._lib.vector.clone=function(a,c){return{x:a,y:c}};Expedition.fn._lib.vector.mult=function(a,d,c){return{x:a*c,y:d*c}};Expedition.fn._lib.vector.add=function(c,f,a,d){return{x:c+a,y:f+d}};Expedition.fn._lib.length=function(a,c){return Math.sqrt(a*a+c*c)};Expedition.fn._lib.random=Expedition.fn._lib.random||{};Expedition.fn._lib.random.randomNum=function(c,a){return Math.random()*(a-c)+c};Expedition.fn._lib.random.randomInt=function(c,a){return Math.floor(Math.random()*(a-c+1))+c};Expedition.fn._lib.random.randomRgba=function(g,d,f){var j=Expedition.fn._lib.random.randomInt(g,d),h=Expedition.fn._lib.random.randomInt(g,d),c=Expedition.fn._lib.random.randomInt(g,d);return Expedition.fn._lib.rgba(j,h,c,f)};Expedition.fn._lib.rgba=function(h,f,c,d){return"rgba("+h+","+f+","+c+","+d+")"};Expedition.fn._lib.rad=function(a){return Math.PI/180*a};Expedition.fn._lib.array=Expedition.fn._lib.array||{};Expedition.fn._lib.array.remove=function(d,f){var a=d.length,c=f;if("function"!=typeof f){c=function(g){return f===g}}while(a--){if(true===c.call(d,d[a],a)){d.splice(a,1)}}};Expedition.fn._lib.array.find=function(g,d){var f,c,a=g.length;if("function"==typeof d){for(c=0;c<a;c++){f=g[c];if(true===d.call(g,f,c)){return f}}}return null};Expedition.fn._lib.array.removeAt=function(c,a){return c.splice(a,1)[0]};Expedition.fn._lib.array.each=function(h,f){var d,g,c,a=h.length;if("function"==typeof f){for(c=0;c<a;c++){g=h[c];d=f.call(h,g,c);if(d===false){break}}}return h};Expedition.fn._lib.vector3d=Expedition.fn._lib.vector3d||{};Expedition.fn._lib.vector3d.rotateX=function(c,g,f,d){return{x:c,y:g*Math.cos(d)-f*Math.sin(d),z:g*Math.sin(d)+f*Math.cos(d)}};Expedition.fn._lib.vector3d.rotateY=function(c,g,f,d){return{x:c*Math.cos(d)+f*Math.sin(d),y:g,z:f*Math.cos(d)-c*Math.sin(d)}};Expedition.fn._lib.vector3d.rotateZ=function(c,g,f,d){return{x:c*Math.cos(d)-g*Math.sin(d),y:c*Math.sin(d)+g*Math.cos(d),z:f}};Expedition.fn._lib.vector3d.spherical=function(d,c,f,g){var g=g||0;return{x:f*Math.sin(d)*Math.cos(c+g),y:f*Math.sin(d)*Math.sin(c+g),z:f*Math.cos(d)}};Expedition.fn._lib.vector3d.transform2d=function(l,g,d,a,o,n){var m=Expedition.fn._lib.vector3d.rotateX(l,g,d,a),j=Expedition.fn._lib.vector3d.rotateY(m.x,m.y,m.z,o),f=Expedition.fn._lib.vector3d.rotateZ(j.x,j.y,j.z,n),c=1-f.z/1000;return{x:f.x/c,y:f.y/c}};Expedition.fn.paint=Expedition.fn.paint||{};Expedition.fn.paint.canvas=function(d,c,a){if(this.id){Expedition.canvas[this.id]._canvas=document.getElementById(d)}Expedition.canvas._canvas=document.getElementById(d);if(c||a){this.size(c,a)}Expedition.fn.paint._newCanvas(this.id);return this};Expedition.fn.paint._getZIndex=function(a){while(a){if(a==document){return 1}if(Expedition.fn.dom.getStyle(a,"z-index")&&Expedition.fn.dom.getStyle(a,"z-index")!="auto"){return Expedition.fn.dom.getStyle(a,"z-index")}a=a.parentNode}};Expedition.fn.paint._newCanvas=function(j){var c=Expedition.fn.paint._getCanvas(j),j=j?"canvasId"+j:false,f,h,g,d,a;if(j){if(!$().g(j)){f=document.createElement("canvas");f.setAttribute("id",j)}else{f=$().g(j)}if(c){g=Expedition.fn.dom.getAttr(c,"id");Expedition.fn.dom.insertAfter(f,c);h=Expedition.fn.dom.getPosition(c);a=Expedition.fn.paint._getZIndex(c);Expedition.fn.dom.setStyles(f,{position:"absolute",left:h.left+"px",top:h.top+"px","z-index":a+1});Expedition.fn.dom.setAttr(f,"index",1);if(f.width!=c.width||f.height!=c.height){f.width=c.width;f.height=c.height}f.setAttribute("BaseCanvas",g)}}if(c){g=Expedition.fn.dom.getAttr(c,"id");h=Expedition.fn.dom.getPosition(c);a=Expedition.fn.paint._getZIndex(c);if(!$().g("eventCanvasId"+g)){d=document.createElement("canvas");d.setAttribute("id","eventCanvasId"+g);Expedition.fn.event._addEventHandle(d);d.setAttribute("BaseCanvas",g)}else{d=$().g("eventCanvasId"+g)}Expedition.fn.dom.insertAfter(d,c);Expedition.fn.dom.setStyles(d,{position:"absolute",left:h.left+"px",top:h.top+"px","z-index":a+10000});Expedition.fn.dom.setAttr(d,"index",10000);Expedition.fn.dom.setAttr(d,"canvasId",g);d.width=c.width;d.height=c.height}};Expedition.fn.paint.setIndex=function(f){var c=Expedition.fn.paint._getCanvas(this.id),d=Expedition.fn.paint._getNewCanvas(this.id),a=Expedition.fn.paint._getZIndex(c);if(f>=10000){f=9999}if(f){Expedition.fn.dom.setStyle(d,"z-index",a+f);Expedition.fn.dom.setAttr(d,"index",f)}return this};Expedition.fn.paint.getIndex=function(){var c=Expedition.fn.paint._getNewCanvas(this.id),a=Expedition.fn.dom.getAttr(c,"index");return a};Expedition.fn.paint._getNewCanvas=function(c){var c=c?"canvasId"+c:false,a;if(!c){a=Expedition.canvas._canvas}else{a=$().g(c)}return a};Expedition.fn.paint._getCanvas=function(c){var a;if(c){a=Expedition.canvas[c]._canvas}else{a=Expedition.canvas._canvas}return a};Expedition.fn.paint.size=function(a,m){var d=Expedition.fn.paint._getCanvas(this.id),c=d.getAttribute("id"),g=document.getElementsByTagName("canvas"),h=g.length,j,l;d.width=a;d.height=m;l=Expedition.fn.dom.getPosition(d);for(var f=0;f<h;f++){j=g[f].getAttribute("BaseCanvas");if(j==c&&(g[f].width!=d.width||g[f].heigth!=d.height)){g[f].width=d.width;g[f].height=d.height;$().setStyles(g[f],{left:l.left+"px",top:l.top+"px"})}}return this};Expedition.fn.paint.context=function(c){var a=Expedition.fn.paint._getNewCanvas(this.id);Expedition.canvas[this.id]._context=a.getContext(c);Expedition.canvas._context=Expedition.canvas._canvas.getContext(c);return this};Expedition.fn.paint._getContext=function(d){var c=null,a;if(d){if(Expedition.canvas[d]._context){c=Expedition.canvas[d]._context}else{a=Expedition.fn.paint._getNewCanvas(d);c=a.getContext("2d")}}else{if(Expedition.canvas._context){c=Expedition.canvas._context}else{c=Expedition.canvas._canvas.getContext("2d")}}return c};Expedition.fn.paint._setContext=function(d,c){var a=Expedition.fn.paint._getContext(d);if(c){if(c.strokeStyle){a.strokeStyle=c.strokeStyle}if(c.linewidth){a.linewidth=c.linewidth}if(c.lineCap){if(c.lineCap=="butt"||c.lineCap=="round"||c.lineCap=="square"){a.lineCap=c.lineCap}}if(c.lineJoin){if(c.lineJoin=="miter"||c.lineJoin=="round"||c.lineJoin=="bevel"){a.lineJoin=c.lineJoin}}if(c.miterLimit){a.miterLimit=c.miterLimit}if(c.fillStyle){a.fillStyle=c.fillStyle}if(c.shadowBlur){a.shadowBlur=c.shadowBlur}if(c.shadowColor){a.shadowColor=c.shadowColor}if(c.shadowOffsetX){a.shadowOffsetX=c.shadowOffsetX}if(c.shadowOffsetY){a.shadowOffsetY=c.shadowOffsetY}}return this};Expedition.fn.paint.line=function(a,h,f,d,g){var c=Expedition.fn.paint._getContext(this.id);c.beginPath();c.moveTo(a,h);Expedition.fn.paint._setContext(this.id,g);c.lineTo(f,d);c.stroke();c.closePath();return this};Expedition.fn.paint.rect=function(h,g,d,a,f){var c=Expedition.fn.paint._getContext(this.id);c.beginPath();c.moveTo(h,g);Expedition.fn.paint._setContext(this.id,f);c.strokeRect(h,g,d,a);if(f){if(f.fillStyle){c.fillRect(h,g,d,a)}}c.closePath();return this};Expedition.fn.paint.clearRect=function(h,g,d,a,f){var c=Expedition.fn.paint._getContext(this.id);Expedition.fn.paint._setContext(this.id,f);c.clearRect(h,g,d,a);return this};Expedition.fn.paint.fillRect=function(h,g,d,a,f){var c=Expedition.fn.paint._getContext(this.id);Expedition.fn.paint._setContext(this.id,f);c.fillRect(h,g,d,a);return this};Expedition.fn.paint.strokeRect=function(h,g,d,a,f){var c=Expedition.fn.paint._getContext(this.id);Expedition.fn.paint._setContext(this.id,f);c.strokeRect(h,g,d,a);return this};Expedition.fn.paint.arc=function(l,j,a,f,c,g,h){var d=Expedition.fn.paint._getContext(this.id);Expedition.fn.paint._setContext(this.id,h);d.beginPath();d.arc(l,j,a,f,c,g);d.stroke();if(h){if(h.fillStyle){d.fill()}}return this};Expedition.fn.paint.epitrochoid=function(l,g,u,s,q,m){var h,t,d,r,u=u+0,s=s+0,q=q+0,o=parseInt(u),n=parseInt(s),v=0,p=1,j,f=Expedition.fn.paint._getContext(this.id);f.save();f.translate(l,g);f.beginPath();Expedition.fn.paint._setContext(this.id,m);h=(u+s)*Math.cos(0)-q*Math.cos(0);t=(u+s)*Math.sin(0)-q*Math.sin(0);f.moveTo(h,t);do{v++}while((n*v)%(o+n)!=0);do{if(p>(n*v)/(o+n)*360){break}j=Math.PI/180*p;d=(u+s)*Math.cos(j)-q*Math.cos((u/s+1)*j);r=(u+s)*Math.sin(j)-q*Math.sin((u/s+1)*j);f.lineTo(d,r);p++}while(h!=d||t!=r);f.stroke();f.restore();return this};Expedition.fn.paint.hypotrochoid=function(l,g,u,s,q,m){var h,t,d,r,u=u+0,s=s+0,q=q+0,o=parseInt(u),n=parseInt(s),v=0,p=1,j,f=Expedition.fn.paint._getContext(this.id);f.save();f.translate(l,g);f.beginPath();Expedition.fn.paint._setContext(this.id,m);h=(u-s)*Math.cos(0)+q*Math.cos(0);t=(u-s)*Math.sin(0)-q*Math.sin(0);f.moveTo(h,t);do{v++}while((n*v)%(o-n)!=0);do{if(p>(n*v)/(o-n)*360){break}j=Math.PI/180*p;d=(u-s)*Math.cos(j)+q*Math.cos((u/s-1)*j);r=(u-s)*Math.sin(j)-q*Math.sin((u/s-1)*j);f.lineTo(d,r);p++}while(h!=d||t!=r);f.stroke();f.restore();return this};Expedition.fn.paint.epicycloid=function(h,d,j,p){var f,o,a,m,l=1,g,p=p||50,c=Expedition.fn.paint._getContext(this.id);c.save();c.translate(h,d);c.beginPath();f=p*(Math.cos(0)+1/j*Math.cos(0));o=p*(Math.sin(0)+1/j*Math.sin(0));c.moveTo(f,o);do{if(l>360){break}g=Math.PI/180*l;a=p*(Math.cos(g)+1/j*Math.cos(j*g));m=p*(Math.sin(g)+1/j*Math.sin(j*g));c.lineTo(a,m);l++}while(f!=a||o!=m);c.stroke();c.restore();return this};Expedition.fn.paint.hypocycloid=function(h,d,j,p){var f,o,a,m,l=1,g,p=p||50,c=Expedition.fn.paint._getContext(this.id);c.save();c.translate(h,d);c.beginPath();f=p*(Math.cos(0)+1/j*Math.cos(0));o=p*(Math.sin(0)-1/j*Math.sin(0));c.moveTo(f,o);do{if(l>360){break}g=Math.PI/180*l;a=p*(Math.cos(g)+1/j*Math.cos(j*g));m=p*(Math.sin(g)-1/j*Math.sin(j*g));c.lineTo(a,m);l++}while(f!=a||o!=m);c.stroke();c.restore();return this};Expedition.fn.paint.save=function(){var a=Expedition.fn.paint._getContext(this.id);a.save();return this};Expedition.fn.paint.restore=function(){var a=Expedition.fn.paint._getContext(this.id);a.restore();return this};Expedition.fn.paint.translate=function(d,c){var a=Expedition.fn.paint._getContext(this.id);a.translate(d,c);return this};Expedition.fn.paint.beginPath=function(){var a=Expedition.fn.paint._getContext(this.id);a.beginPath();return this};Expedition.fn.paint.closePath=function(){var a=Expedition.fn.paint._getContext(this.id);a.closePath();return this};Expedition.fn.paint.fill=function(c){var a=Expedition.fn.paint._getContext(this.id);Expedition.fn.paint._setContext(this.id,c);a.fill();return this};Expedition.fn.paint.stroke=function(c){var a=Expedition.fn.paint._getContext(this.id);Expedition.fn.paint._setContext(this.id,c);a.stroke();return this};Expedition.fn.paint.clip=function(){var a=Expedition.fn.paint._getContext(this.id);a.clip();return this};Expedition.fn.paint.moveTo=function(d,c){var a=Expedition.fn.paint._getContext(this.id);a.moveTo(d,c);return this};Expedition.fn.paint.lineTo=function(d,c){var a=Expedition.fn.paint._getContext(this.id);a.lineTo(d,c);return this};Expedition.fn.paint.arcTo=function(h,g,f,d,a){var c=Expedition.fn.paint._getContext(this.id);c.arcTo(h,g,f,d,a);return this};Expedition.fn.paint.bezierCurveTo=function(f,j,c,h,g,d){var a=Expedition.fn.paint._getContext(this.id);a.bezierCurveTo(f,j,c,h,g,d);return this};Expedition.fn.paint.quadraticCurveTo=function(g,f,d,c){var a=Expedition.fn.paint._getContext(this.id);a.quadraticCurveTo(g,f,d,c);return this};Expedition.fn.paint.isPointInPath=function(d,c){var a=Expedition.fn.paint._getContext(this.id);return a.isPointInPath(d,c)};Expedition.fn.paint.customCurves=function(g,j,m){var c=this.id,h,l=1,f=Expedition.fn.paint._getNewCanvas(c),d=f.width,a=Expedition.fn.paint._getContext(c);if(typeof(g)=="function"){h=g(j);a.save();a.moveTo(j,h);if(j>m){l=-1;if(j>d){j=d}}else{if(j<m){if(j<0){j=0}}else{return this}}while(j!=m||j>d||j<0){j+=l;h=g(j);a.lineTo(j,h)}a.stroke();a.restore()}return this};Expedition.fn.render=Expedition.fn.render||{};Expedition.fn.render.getStrokeStyle=function(){var a=Expedition.fn.paint._getContext(this.id);return a.strokeStyle};Expedition.fn.render.setStrokeStyle=function(c){var a=Expedition.fn.paint._getContext(this.id);a.strokeStyle=c;return this};Expedition.fn.render.getLineWidth=function(){var a=Expedition.fn.paint._getContext(this.id);return a.lineWidth};Expedition.fn.render.setLineWidth=function(a){var c=Expedition.fn.paint._getContext(this.id);c.lineWidth=a;return this};Expedition.fn.render.getLineCap=function(){var a=Expedition.fn.paint._getContext(this.id);return a.lineCap};Expedition.fn.render.setLineCap=function(c){var a=Expedition.fn.paint._getContext(this.id);a.lineCap=c;return this};Expedition.fn.render.getLineJoin=function(){var a=Expedition.fn.paint._getContext(this.id);return a.lineJoin};Expedition.fn.render.setLineJoin=function(a){var c=Expedition.fn.paint._getContext(this.id);c.lineJoin=a;return this};Expedition.fn.render.getMiterLimit=function(){var a=Expedition.fn.paint._getContext(this.id);return a.miterLimit};Expedition.fn.render.setMiterLimit=function(a){var c=Expedition.fn.paint._getContext(this.id);c.miterLimit=a;return this};Expedition.fn.render.getFillStyle=function(){var a=Expedition.fn.paint._getContext(this.id);return a.fillStyle};Expedition.fn.render.setFillStyle=function(a){var c=Expedition.fn.paint._getContext(this.id);c.fillStyle=a;return this};Expedition.fn.render.getShadowBlur=function(){var a=Expedition.fn.paint._getContext(this.id);return a.shadowBlur};Expedition.fn.render.setShadowBlur=function(a){var c=Expedition.fn.paint._getContext(this.id);c.shadowBlur=a;return this};Expedition.fn.render.getShadowColor=function(){var a=Expedition.fn.paint._getContext(this.id);return a.shadowColor};Expedition.fn.render.setShadowColor=function(c){var a=Expedition.fn.paint._getContext(this.id);a.shadowColor=c;return this};Expedition.fn.render.getShadowOffsetX=function(){var a=Expedition.fn.paint._getContext(this.id);return a.shadowOffsetX};Expedition.fn.render.setShadowOffsetX=function(c){var a=Expedition.fn.paint._getContext(this.id);a.shadowOffsetX=c;return this};Expedition.fn.render.getShadowOffsetY=function(){var a=Expedition.fn.paint._getContext(this.id);return a.shadowOffsetY};Expedition.fn.render.setShadowOffsetY=function(c){var a=Expedition.fn.paint._getContext(this.id);a.setShadowOffsetY=setShadowOffsetY;return this};Expedition.fn.render.getShadow=function(){var a=Expedition.fn.paint._getContext(this.id);return{shadowBlur:a.shadowBlur,shadowColor:a.shadowColor,shadowOffsetX:a.shadowOffsetX,shadowOffsetY:a.shadowOffsetY}};Expedition.fn.render.setShadow=function(c){var a=Expedition.fn.paint._getContext(this.id);a.shadowBlur=c.shadowBlur;a.shadowColor=c.shadowColor;a.shadowOffsetX=c.shadowOffsetX;a.shadowOffsetY=c.shadowOffsetY;return this};Expedition.fn.render.getCompositeOperation=function(){var a=Expedition.fn.paint._getContext(this.id);return a.globalCompositeOperation};Expedition.fn.render.setCompositeOperation=function(c){var a=Expedition.fn.paint._getContext(this.id);a.globalCompositeOperation=c;return this};Expedition.fn.render.rotate=function(c){var a=Expedition.fn.paint._getContext(this.id);a.rotate(c);return this};Expedition.fn.render.scale=function(d,a){var c=Expedition.fn.paint._getContext(this.id);c.scale(d,a);return this};Expedition.fn.render.createLinearGradient=function(c,g,a,f){var d=Expedition.fn.paint._getContext(this.id);this._gradient=d.createLinearGradient(c,g,a,f);return this};Expedition.fn.render.createRadialGradient=function(f,j,d,c,h,a){var g=Expedition.fn.paint._getContext(this.id);this._gradient=g.createRadialGradient(f,j,d,c,h,a);return this};Expedition.fn.render.addColorStop=function(a,c){if(this._gradient){this._gradient.addColorStop(a,c)}return this};Expedition.fn.render.getGradient=function(){return this._gradient};Expedition.fn.render.randomRgba=function(f,c,d){return Expedition.fn._lib.random.randomRgba(f,c,d)};Expedition.fn.render.heart=function(a,h,f,c){var d=Expedition.fn.paint._getContext(this.id),g;d.save();d.translate(a,h);if(f){g=f/80;d.scale(g,g)}d.beginPath();d.bezierCurveTo(0,-3,-5,-15,-25,-15);d.bezierCurveTo(-55,-15,-53,22.5,-53,15);d.bezierCurveTo(-55,40,-35,62,0,80);d.bezierCurveTo(35,62,55,40,53,15);d.bezierCurveTo(53,15,55,-15,25,-15);d.bezierCurveTo(10,-15,0,-3,0,0);d.closePath();d.restore();d.save();if(c){d.fillStyle=c}else{d.fillStyle="rgba(255,0,0,1)"}d.fill();d.restore();return this};Expedition.fn.render.flower=function(m,l,A){var d=Expedition.fn.paint._getContext(this.id),A=A||{},c=A.petal,u=A.petalNum,f=A.petalColor,j=A.isColorSame==false?false:true,B=A.isShapeSame,g=A.petalMaxLength||20,C=A.petalMinLength||10,p=A.petalMaxAngle,h=A.petalMinAngle,q,v=A.speed||0,s,r,z,o,n,t=A.startAngle||0,a=t;d.save();this._x=0;this._y=0;if(c){var w=c.length;for(i=0;i<w;i++){c[i].render()}return}if(!u){u=Expedition.fn._lib.random.randomInt(6,15)}for(i=0;i<u;i++){if(f){s=f}else{if(!j||!s){s=Expedition.fn._lib.random.randomRgba(0,255,0.5)}}z=360/u;if(B){if(!r){r=Expedition.fn._lib.random.randomNum(C,g)}}else{r=Expedition.fn._lib.random.randomNum(C,g)}if(A.gap){q=A.gap}else{q=Expedition.fn._lib.random.randomNum(0.1,1)}if(A.shapevar1){o=A.shapevar1}else{if(!B||!o){o=Expedition.fn._lib.random.randomNum(0.1,3)}}if(A.shapevar2){n=A.shapevar2}else{if(!B||!n){n=Expedition.fn._lib.random.randomNum(0.1,3)}}new Expedition.fn.render.petal(m,l,{petalColor:s,petalLength:r,petalAngle:z,startAngle:a,shapevar1:o,shapevar2:n,gap:q,speed:v,id:this.id})._render();a+=z}d.restore();return this};Expedition.fn.render.petal=function(a,d,c){var c=c||{};this.x=a;this.y=d;this.petalColor=c.petalColor;this.petalLength=c.petalLength;this.petalLen=1;this.petalAngle=c.petalAngle;this.gap=c.gap;this.startAngle=c.startAngle||0;this.shapevar1=c.shapevar1;this.shapevar2=c.shapevar2;this.curveX1=c.curveX1;this.curveY1=c.curveY1;this.curveX2=c.curveX2;this.curveY2=c.curveY2;this.speed=c.speed;this.id=c.id;return this};Expedition.fn.render.petal.prototype={_paint:function(){var d=Expedition.fn.paint._getContext(this.id),g=Expedition.fn._lib.vector.rotate(0,this.petalLen,this.startAngle),f=Expedition.fn._lib.vector.rotate(g.x,g.y,this.petalAngle),c=Expedition.fn._lib.vector.mult(g.x,g.y,this.shapevar1),a=Expedition.fn._lib.vector.mult(f.x,f.y,this.shapevar2);d.save();d.beginPath();d.moveTo(g.x,g.y);d.strokeStyle=this.petalColor;if(this.curveX1&&this.curveY1&&this.curveX2&&this.curveY2){d.bezierCurveTo(this.curveX1,this.curveY1,this.curveX2,this.curveY2,this.x,this.y);d.closePath();d.stroke();d.restore();return}d.bezierCurveTo(c.x,c.y,a.x,a.y,f.x,f.y);d.stroke();d.restore();return},_render:function(){if(this.petalLen<this.petalLength){var c=this,d=this.id,a=Expedition.fn.paint._getContext(d);setTimeout(function(){a.save();a.translate(c.x+Expedition.canvas[d]._x,c.y+Expedition.canvas[d]._y);c.petalLen+=c.gap;c._paint();a.restore();c._render()},c.speed)}return}};Expedition.fn.render.ball=function(n,m,o,v,f,s){var p=this.id,d=Expedition.fn.paint._getNewCanvas(p),a=d.getContext("2d"),s=s||Math.PI/200,j=Math.PI/3,h=0,g=0,l=0,u,c,v=v||false,f=f==false?false:true,w,t=0,q=0;this._x=0;this._y=0;Expedition.fn.render._drawBall(p,n+t,m+q,o,j,h,g,l);if(v==true||v=="r"||v=="R"){w=setInterval(function(){l+=s;t=Expedition.canvas[p]._x;q=Expedition.canvas[p]._y;Expedition.fn.render._drawBall(p,n+t,m+q,o,j,h,g,l)},25)}else{if(v=="x"||v=="X"){w=setInterval(function(){j+=s;t=Expedition.canvas[p]._x;q=Expedition.canvas[p]._y;Expedition.fn.render._drawBall(p,n+t,m+q,o,j,h,g,l)},25)}else{if(v=="y"||v=="Y"){w=setInterval(function(){h+=s;t=Expedition.canvas[p]._x;q=Expedition.canvas[p]._y;Expedition.fn.render._drawBall(p,n+t,m+q,o,j,h,g,l)},25)}else{if(v=="z"||v=="Z"){w=setInterval(function(){g+=s;t=Expedition.canvas[p]._x;q=Expedition.canvas[p]._y;Expedition.fn.render._drawBall(p,n+t,m+q,o,j,h,g,l)},25)}}}}this._otherLoop=this._otherLoop||{};this._otherLoop.ballLoop=w;if(f){$(p).addEvent("onmousedown",function(x){u=Expedition.fn.event.getPageX(x);c=Expedition.fn.event.getPageY(x);var r=function(A){var y=Expedition.fn.event.getPageX(A),z=Expedition.fn.event.getPageY(A);j=j+(c-z)*(Math.PI/(2*o));h=h-(u-y)*(Math.PI/(2*o));u=y;c=z;t=Expedition.canvas[p]._x;q=Expedition.canvas[p]._y;Expedition.fn.render._drawBall(p,n+t,m+q,o,j,h,g,l)};Expedition.fn.on(document,"onmousemove",r);Expedition.fn.on(document,"onmouseup",function(y){Expedition.fn.un(document,"onmousemove",r)})},{fireEvent:function(x,r){return(x-n)*(x-n)+(r-m)*(r-m)<=o*o},isFireMove:true})}return this};Expedition.fn.render.stopBallLoop=function(){var a=this._otherLoop;if(a&&a.ballLoop){clearInterval(a.ballLoop)}return this};Expedition.fn.render._drawBall=function(s,o,n,p,h,g,f,m){var o=o||0,n=n||0,p=p||100,d=Expedition.fn.paint._getNewCanvas(s),a=d.getContext("2d"),t=d.width,q=d.height;a.save();a.clearRect(0,0,t,q);a.beginPath();a.translate(o,n);for(var v=0;v<=Math.PI;v+=Math.PI/8){var z=Expedition.fn._lib.vector3d.spherical(v,0,p,m),l=Expedition.fn._lib.vector3d.transform2d(z.x,z.y,z.z,h,g,f);a.moveTo(l.x,l.y);for(var u=0;u<=2*Math.PI;u+=Math.PI/200){var w=Expedition.fn._lib.vector3d.spherical(v,u,p,m),c=Expedition.fn._lib.vector3d.transform2d(w.x,w.y,w.z,h,g,f);a.lineTo(c.x,c.y)}}for(var u=0;u<=2*Math.PI;u+=Math.PI/4){var z=Expedition.fn._lib.vector3d.spherical(0,0,p,m),l=Expedition.fn._lib.vector3d.transform2d(z.x,z.y,z.z,h,g,f);a.moveTo(l.x,l.y);for(var v=0;v<=Math.PI;v+=Math.PI/200){var w=Expedition.fn._lib.vector3d.spherical(v,u,p,m),c=Expedition.fn._lib.vector3d.transform2d(w.x,w.y,w.z,h,g,f);a.lineTo(c.x,c.y)}}a.stroke();a.restore()};Expedition.fn.render.cube=function(p,o,s,r,z,B,f,v){var q=this.id,d=Expedition.fn.paint._getNewCanvas(q),a=d.getContext("2d"),v=v||Math.PI/200,l=Math.PI/3,j=0,g=0,A,c,B=B||false,f=f==false?false:true,C,u=s>r?s:r,u=u>z?u:z,w=0,t=0;this._x=0;this._y=0;Expedition.fn.render._drawCube(q,p+w,o+t,s,r,z,l,j,g);if(B==true||B=="x"||B=="X"){C=setInterval(function(){l+=v;w=Expedition.canvas[q]._x;t=Expedition.canvas[q]._y;Expedition.fn.render._drawCube(q,p+w,o+t,s,r,z,l,j,g)},25)}else{if(B=="y"||B=="Y"){C=setInterval(function(){j+=v;w=Expedition.canvas[q]._x;t=Expedition.canvas[q]._y;Expedition.fn.render._drawCube(q,p+w,o+t,s,r,z,l,j,g)},25)}else{if(B=="z"||B=="Z"){C=setInterval(function(){g+=v;w=Expedition.canvas[q]._x;t=Expedition.canvas[q]._y;Expedition.fn.render._drawCube(q,p+w,o+t,s,r,z,l,j,g)},25)}}}this._otherLoop=this._otherLoop||{};this._otherLoop.cubeLoop=C;if(f){$(q).addEvent("onmousedown",function(m){A=Expedition.fn.event.getPageX(m);c=Expedition.fn.event.getPageY(m);var h=function(y){var n=Expedition.fn.event.getPageX(y),x=Expedition.fn.event.getPageY(y);l=l+(c-x)*(Math.PI/s);j=j-(A-n)*(Math.PI/z);A=n;c=x;w=Expedition.canvas[q]._x;t=Expedition.canvas[q]._y;Expedition.fn.render._drawCube(q,p+w,o+t,s,r,z,l,j,g)};Expedition.fn.on(document,"onmousemove",h);Expedition.fn.on(document,"onmouseup",function(n){Expedition.fn.un(document,"onmousemove",h)})},{fireEvent:function(m,h){return(m-p)*(m-p)+(h-o)*(h-o)<=u*u/4},isFireMove:true})}return this};Expedition.fn.render.stopCubeLoop=function(){var a=this._otherLoop;if(a&&a.cubeLoop){clearInterval(a.cubeLoop)}return this};Expedition.fn.render._drawCube=function(g,t,s,q,o,r,j,c,a){var p=Expedition.fn._lib.vector3d.transform2d,l=Expedition.fn.paint._getNewCanvas(g),f=l.getContext("2d"),d=l.width,u=l.height;f.save();f.clearRect(0,0,d,u);f.beginPath();f.translate(t,s);f.moveTo(p(-q/2,-r/2,-o/2,j,c,a).x,p(-q/2,-r/2,-o/2,j,c,a).y);f.lineTo(p(q/2,-r/2,-o/2,j,c,a).x,p(q/2,-r/2,-o/2,j,c,a).y);f.lineTo(p(q/2,r/2,-o/2,j,c,a).x,p(q/2,r/2,-o/2,j,c,a).y);f.lineTo(p(-q/2,r/2,-o/2,j,c,a).x,p(-q/2,r/2,-o/2,j,c,a).y);f.lineTo(p(-q/2,-r/2,-o/2,j,c,a).x,p(-q/2,-r/2,-o/2,j,c,a).y);f.lineTo(p(-q/2,-r/2,o/2,j,c,a).x,p(-q/2,-r/2,o/2,j,c,a).y);f.lineTo(p(q/2,-r/2,o/2,j,c,a).x,p(q/2,-r/2,o/2,j,c,a).y);f.lineTo(p(q/2,r/2,o/2,j,c,a).x,p(q/2,r/2,o/2,j,c,a).y);f.lineTo(p(-q/2,r/2,o/2,j,c,a).x,p(-q/2,r/2,o/2,j,c,a).y);f.lineTo(p(-q/2,-r/2,o/2,j,c,a).x,p(-q/2,-r/2,o/2,j,c,a).y);f.moveTo(p(q/2,-r/2,o/2,j,c,a).x,p(q/2,-r/2,o/2,j,c,a).y);f.lineTo(p(q/2,-r/2,-o/2,j,c,a).x,p(q/2,-r/2,-o/2,j,c,a).y);f.moveTo(p(q/2,r/2,o/2,j,c,a).x,p(q/2,r/2,o/2,j,c,a).y);f.lineTo(p(q/2,r/2,-o/2,j,c,a).x,p(q/2,r/2,-o/2,j,c,a).y);f.moveTo(p(-q/2,r/2,o/2,j,c,a).x,p(-q/2,r/2,o/2,j,c,a).y);f.lineTo(p(-q/2,r/2,-o/2,j,c,a).x,p(-q/2,r/2,-o/2,j,c,a).y);f.stroke();f.restore()};Expedition.fn.render.burn=function(h,r,u,q){var m=this.id,t,c=Expedition.fn.paint._getContext(m),d=Expedition.fn.paint._getNewCanvas(m),o=d.width,j=d.height,n=[],l=c.getImageData(0,0,o,j),a=c.getImageData(0,0,o,j),g=c.createImageData(o,j),s=o*j*4,h=h||100,v=255/h,r=r||50,w,f;for(var p=0;p<64;p++){n[p]=[p*4,0,0];n[p+64]=[255,p*4,0];n[p+128]=[255,255,p*4];n[p+192]=[255,255,255]}if(r&&!isNaN(Number(r))&&r.toString().match(/^\s+$/)===null){w=r}else{switch(r){case"fast":w=25;break;case"slow":w=100;break;default:case"normal":w=50;break}}f=function(){for(var A=0;A<s;A+=4){if(a.data[A]!=0||a.data[A+1]!=0||a.data[A+2]!=0||a.data[A+3]!=0){if(!q){g.data[A]=Math.floor(Math.random()*255)}}else{if(q){g.data[A]=Math.floor(Math.random()*255)}}}for(var A=0;A<s-o*4;A+=4){var z=g.data[((A%(o*4)==0)?A+(o*4):A)-4];var B=g.data[((A%(o*4)==(o*4)-4)?A-(o*4):A)+4];var x=g.data[A+(o*4)];var C=Math.floor((z+B+x+x)/4);if(C>0){C-=v}if(C<0){C=0}g.data[A]=C}for(var A=0;A<s;A+=4){if(g.data[A]!=0){var D=g.data[A];var y=(1-(3*D)/255);if(y<0){y=0}if(y>255){y=255}l.data[A]=Math.min(255,n[D][0]+Math.floor(255*y));l.data[A+1]=Math.min(255,n[D][1]+Math.floor(255*y));l.data[A+2]=Math.min(255,n[D][2]+Math.floor(255*y));l.data[A+3]=Math.max(255,Math.min(3*D,255))}if(!u&&(a.data[A]!=0||a.data[A+1]!=0||a.data[A+2]!=0||a.data[A+3]!=0)){l.data[A]=a.data[A];l.data[A+1]=a.data[A+1];l.data[A+2]=a.data[A+2];l.data[A+3]=a.data[A+3]}}c.putImageData(l,0,0)};t=setInterval(f,w);this._otherLoop=this._otherLoop||{};this._otherLoop.burnLoop={loop:t,imageBase:a};return this};Expedition.fn.render.stopBurn=function(){var h=this.id,d=Expedition.fn.paint._getContext(h),c=Expedition.fn.paint._getNewCanvas(h),f=c.width,a=c.height,g=this._otherLoop;if(g&&g.burnLoop){clearInterval(g.burnLoop.loop);d.clearRect(0,0,f,a);d.putImageData(g.burnLoop.imageBase,0,0)}return this};Expedition.fn.text=Expedition.fn.text||{};Expedition.fn.text.getFont=function(){var a=this.id;context=Expedition.fn.paint._getContext(a);return context.font};Expedition.fn.text.setFont=function(a){var c=this.id;context=Expedition.fn.paint._getContext(c);if(typeof(a)=="number"){a=a+"px sans-serif"}context.font=a;return this};Expedition.fn.text.getTextAlign=function(){var a=this.id;context=Expedition.fn.paint._getContext(a);return context.textAlign};Expedition.fn.text.setTextAlign=function(a){var c=this.id;context=Expedition.fn.paint._getContext(c);context.textAlign=a;return this};Expedition.fn.text.getTextBaseline=function(){var a=this.id;context=Expedition.fn.paint._getContext(a);return context.textBaseline};Expedition.fn.text.setTextBaseline=function(a){var c=this.id;context=Expedition.fn.paint._getContext(c);context.textBaseline=a;return this};Expedition.fn.text.fillText=function(f,a,h,d){var g=this.id,c=Expedition.fn.paint._getContext(g);if(d){c.fillText(f,a,h,d)}else{c.fillText(f,a,h)}return this};Expedition.fn.text.strokeText=function(f,a,h,d){var g=this.id,c=Expedition.fn.paint._getContext(g);if(d){c.strokeText(f,a,h,d)}else{c.strokeText(f,a,h)}return this};Expedition.fn.text.measureText=function(c){var d=this.id,a=Expedition.fn.paint._getContext(d);return a.measureText(c)};Expedition.fn.text.write=function(t,g,q,o,r,n,p,s){var d=this.id,c=Expedition.fn.paint._getContext(d),m=q,j=o,h=0,l,f,a,u=parseInt(c.font),p=p||0;f=function(){c.save();$(d).setFont(u);if(h<t.length){a=t.charAt(h);if(m+c.measureText(a).width<=r+q){}else{m=q;j+=u+p}if(n=="stroke"){c.strokeText(a,m,j)}else{if(n=="fill"){c.fillText(a,m,j)}else{c.fillText(a,m,j);c.strokeText(a,m,j)}}m+=c.measureText(a).width}else{clearInterval(l)}h++;if(h==t.length){if(typeof(s)=="function"){s()}}c.restore()};l=setInterval(f,g);return this};Expedition.fn.move=Expedition.fn.move||{};Expedition.fn.move._addMoveHandle=function(F,L,M,c){var J=c.x||0,H=c.y||0,Q=c.time,O=c.speed,D,n=c.distance,q=c.moveFlag,I=c.callback,f=Expedition.canvas[F]._loop||[],U,g=$().g(M),w=Expedition.fn.paint._getZIndex(g),a=g.width,d=g.height,T=g.getContext("2d"),P,G,r=g.getAttribute("BaseCanvas"),t=Expedition.fn.dom.getPosition(r),u=document.createElement("canvas"),h="moveCanvasId"+L,m,A=true,l,j,z=0,v=0,B=0,S,R,s=document.createElement("canvas"),K,o=q,p=Expedition.fn.paint._getContext(F),N=c.queueFlag,E=0,C=0;if(!$().g(h)){u.setAttribute("BaseCanvas",r);u.setAttribute("id",h);Expedition.fn.dom.insertAfter(u,g);$().setStyles(u,{position:"absolute",left:t.left+"px",top:t.top+"px","z-index":w+1});u.width=a;u.height=d}if(!$().g("temp"+h)){s.setAttribute("BaseCanvas",r);s.setAttribute("id","temp"+h);Expedition.fn.dom.insertAfter(s,g);$().setStyles(s,{position:"absolute",left:t.left+"px",top:t.top+"px",display:"none"});s.width=a;s.height=d;K=s.getContext("2d")}$().setStyle(g,"display","none");G=u.getContext("2d");m=function(){f=Expedition.canvas[F]._loop||[];for(var x=0;x<f.length;x++){if(f[x].id==h){R=f[x]}}if(R){o=R.moveFlag;E=R.dragX||0;C=R.dragY||0}B+=25;if(o===0){if(typeof(J)=="number"){l=J}else{if(typeof(J)=="function"){l=J(B,z,v)}else{l=0}}if(typeof(H)=="number"){j=H}else{if(typeof(H)=="function"){j=H(B,z,v)}else{j=0}}if(typeof(O)=="number"){S=O}else{if(typeof(O)=="function"){S=O(B,z,v)}else{D=1}}G.clearRect(0,0,a,d);if(D){z+=l;v+=j;R.x+=l;R.y+=j}else{z+=Math.cos(Math.atan((j+0)/l))*S;v+=Math.sin(Math.atan((j+0)/l))*S;R.x+=Math.cos(Math.atan((j+0)/l))*S+E;R.y+=Math.sin(Math.atan((j+0)/l))*S+C}if(R){M=R.pre}g=$().g(M);T=g.getContext("2d");P=T.getImageData(0,0,a,d);G.putImageData(P,z+E,v+C);K.clearRect(0,0,a,d);P=p.getImageData(0,0,a,d);K.putImageData(P,z+E,v+C);if(Q&&B>=Q){A=false}if(n&&z*z+v*v>=n*n){A=false}if(A){setTimeout(m,25)}else{Expedition.canvas[F]._x+=z+E;Expedition.canvas[F]._y+=v+C;P=K.getImageData(0,0,a,d);p.clearRect(0,0,a,d);p.putImageData(P,0,0);setTimeout(function(){setTimeout(function(){Expedition.fn.dom.remove(s);Expedition.fn.dom.remove(u)},25);if(f[f.length-1].id==h){$().setStyle(g,"display","block")}Expedition.fn._lib.array.remove(f,function(y){return y.id==h});if(N){Expedition.fn._lib.array.removeAt(Expedition.canvas[F]._queueList,0);if(Expedition.canvas[F]._queueList.length>0){$(F).addMove(Expedition.canvas[F]._queueList[0].moveId,Expedition.canvas[F]._queueList[0].params)}}},25);if(f[f.length-1].id!=h){for(var x=0;x<f.length;x++){if(f[x].pre==h){f[x].pre=M}}}if(typeof(I)=="function"){I(B,z,v)}}}else{if(o===1){B-=25;setTimeout(m,25)}else{Expedition.canvas[F]._x+=z+E;Expedition.canvas[F]._y+=v+C;P=K.getImageData(0,0,a,d);p.clearRect(0,0,a,d);p.putImageData(P,0,0);setTimeout(function(){setTimeout(function(){Expedition.fn.dom.remove(s);Expedition.fn.dom.remove(u)},25);if(f[f.length-1].id==h){$().setStyle(g,"display","block")}Expedition.fn._lib.array.remove(f,function(y){return y.id==h});if(N){Expedition.fn._lib.array.removeAt(Expedition.canvas[F]._queueList,0);if(Expedition.canvas[F]._queueList.length>0){$(F).addMove(Expedition.canvas[F]._queueList[0].moveId,Expedition.canvas[F]._queueList[0].params)}}},25);if(f[f.length-1].id!=h){for(var x=0;x<f.length;x++){if(f[x].pre==h){f[x].pre=M}}}if(typeof(I)=="function"){I(B,z,v)}}}};U=setTimeout(m,25);Expedition.canvas[F]._loop=Expedition.canvas[F]._loop||[];Expedition.canvas[F]._loop[Expedition.canvas[F]._loop.length]={id:h,pre:M,moveLoop:U,moveFlag:0,currentTheta:0,x:0,y:0}};Expedition.fn.move.addMove=function(a,g){var j=this.id,f,h=this._loop||[],d,c;queue=this._queue;if(typeof(a)=="object"){d=Math.random();c=a}else{d=a;c=g}if(queue&&!c.queueFlag){this._queueList=this._queueList||[];c.queueFlag=true;this._queueList[this._queueList.length]={moveId:d,params:c};if(this._queueList.length==1){$(j).addMove(d,c)}}else{if(h.length>0){f=h[h.length-1].id}else{f="canvasId"+j}Expedition.fn.move._addMoveHandle(j,d,f,c)}return this};Expedition.fn.move.pauseMove=function(c){var g=this.id,f=this._loop||[],a=f.length;for(var d=0;d<a;d++){if(c&&this._loop[d].id=="moveCanvasId"+c){this._loop[d].moveFlag=1;return this}else{this._loop[d].moveFlag=1}}return this};Expedition.fn.move.runMove=function(c){var g=this.id,f=this._loop||[],a=f.length;for(var d=0;d<a;d++){if(c&&this._loop[d].id=="moveCanvasId"+c){this._loop[d].moveFlag=0;return this}else{this._loop[d].moveFlag=0}}return this};Expedition.fn.move.cancelMove=function(c){var g=this.id,f=this._loop||[],a=f.length;for(var d=0;d<a;d++){if(c&&this._loop[d].id=="moveCanvasId"+c){this._loop[d].moveFlag=2;return this}else{if(!c){this._loop[d].moveFlag=2}}}this._queueList=[];return this};Expedition.fn.move.uniLinMotion=function(a,c){var d=this.id;$(d).addMove(a,c);return this};Expedition.fn.move.accLinMotion=function(a,j){var l=this.id,j=j||{},h,g,f,d,c;if(typeof(a)=="object"){d=Math.random();c=a}else{d=a;c=j}h=c.acc||0;g=c.speed||0;if(typeof(h)=="number"){if(typeof(g)=="number"){f=function(m){return g+m*h/25}}else{if(typeof(g)=="function"){f=function(o,n,m){return g(o,n,m)+o*h/25}}}}else{if(typeof(h)=="function"){if(typeof(g)=="number"){f=function(o,n,m){return g+o*h(o,n,m)/25}}else{if(typeof(g)=="function"){f=function(o,n,m){return g(o,n,m)+o*h(o,n,m)/25}}}}}c.speed=f;$(l).addMove(d,c);return this};Expedition.fn.move.cirMotion=function(j,m){var f=this.id,l,c,q,g,p,o,s,d,n,h;if(typeof(j)=="object"){s=Math.random();d=j}else{s=j;d=m}d=d||{};l=d.time;c=d.r||20;q=d.delta||Math.PI/180;g=(d.theta||0)*Math.PI/180;p=-c*Math.sin(g);o=c*Math.cos(g);if(typeof(q)=="function"){d.x=function(t,r,a){n=Expedition.fn._lib.array.find(Expedition.canvas[f]._loop,function(u){if(u.id=="moveCanvasId"+j){u.currentTheta+=q(t,r,a)*Math.PI/180;return true}});h=n.currentTheta;return c*Math.sin(g+h)-r};d.y=function(t,r,a){n=Expedition.fn._lib.array.find(Expedition.canvas[f]._loop,function(u){if(u.id=="moveCanvasId"+j){u.currentTheta+=q(t,r,a)*Math.PI/180;return true}});h=n.currentTheta;return c*Math.cos(g+h)-a}}else{d.x=function(t,r,a){return c*Math.sin(g+t*q*Math.PI/180/25)-r};d.y=function(t,r,a){return c*Math.cos(g+t*q*Math.PI/180/25)-a}}$(f).addMove(s,d);return this};Expedition.fn.move.parMotion=function(g,h){var f=this.id,m,l,j,n,o,d;if(typeof(g)=="object"){o=Math.random();d=g}else{o=g;d=h}m=d.a||1;l=d.b||0;j=d.c||0;n=d.delta||1;if(typeof(n)=="function"){d.x=function(p,c,a){return n(p,c,a)};d.y=function(p,c,a){return m*(c+n(p,c,a)-l)*(c+n(p,c,a)-l)+j-a}}else{d.x=function(p,c,a){return n};d.y=function(p,c,a){return m*(c+n-l)*(c+n-l)+j-a}}$(f).addMove(o,d);return this};Expedition.fn.move.sinMotion=function(f,g){var d=this.id,m,l,j,h,n,c;if(typeof(f)=="object"){n=Math.random();c=f}else{n=f;c=g}l=c.a||100;j=c.b||0;m=c.delta||1;h=c.rate||1;if(typeof(m)=="function"){c.x=function(p,o,a){return m(p,o,a)};c.y=function(p,o,a){return l*Math.sin((o+m(p,o,a)-j)*Math.PI/180*h)-a}}else{c.x=function(p,o,a){return m};c.y=function(p,o,a){return l*Math.sin((o+m-j)*Math.PI/180*h)-a}}$(d).addMove(n,c);return this};Expedition.fn.move.hypMotion=function(j,l){var f=this.id,p,o,n,q,g,r,d,h,m;if(typeof(j)=="object"){r=Math.random();d=j}else{r=j;d=l}p=d.a;o=d.b;n=d.c;q=d.delta||1;g=(d.theta||0)*Math.PI/180;if(typeof(q)=="function"){d.x=function(s,c,a){m=Expedition.fn._lib.array.find(Expedition.canvas[f]._loop,function(t){if(t.id=="moveCanvasId"+j){t.currentTheta+=q(s,c,a)*Math.PI/180;return true}});h=m.currentTheta;return(p-o)*Math.cos(g+h)+n*Math.cos((p/o-1)*(g+h))-c};d.y=function(s,c,a){m=Expedition.fn._lib.array.find(Expedition.canvas[f]._loop,function(t){if(t.id=="moveCanvasId"+j){t.currentTheta+=q(s,c,a)*Math.PI/180;return true}});h=m.currentTheta;return(p-o)*Math.sin(g+h)-n*Math.sin((p/o-1)*(g+h))-a}}else{d.x=function(s,c,a){h=s*Math.PI/180/25*q;return(p-o)*Math.cos(g+h)+n*Math.cos((p/o-1)*(g+h))-c};d.y=function(s,c,a){h=s*Math.PI/180/25*q;return(p-o)*Math.sin(g+h)-n*Math.sin((p/o-1)*(g+h))-a}}$(f).addMove(r,d);return this};Expedition.fn.move.epiMotion=function(j,l){var f=this.id,p,o,n,q,g,r,d,h,m;if(typeof(j)=="object"){r=Math.random();d=j}else{r=j;d=l}p=d.a;o=d.b;n=d.c;q=d.delta||1;g=(d.theta||0)*Math.PI/180;if(typeof(q)=="function"){d.x=function(s,c,a){m=Expedition.fn._lib.array.find(Expedition.canvas[f]._loop,function(t){if(t.id=="moveCanvasId"+j){t.currentTheta+=q(s,c,a)*Math.PI/180;return true}});h=m.currentTheta;return(p+o)*Math.cos(g+h)-n*Math.cos((p/o+1)*(g+h))-c};d.y=function(s,c,a){m=Expedition.fn._lib.array.find(Expedition.canvas[f]._loop,function(t){if(t.id=="moveCanvasId"+j){t.currentTheta+=q(s,c,a)*Math.PI/180;return true}});h=m.currentTheta;return(p+o)*Math.sin(g+h)-n*Math.sin((p/o+1)*(g+h))-a}}else{d.x=function(s,c,a){h=s*Math.PI/180/25*q;return(p+o)*Math.cos(g+h)-n*Math.cos((p/o+1)*(g+h))-c};d.y=function(s,c,a){h=s*Math.PI/180/25*q;return(p+o)*Math.sin(g+h)-n*Math.sin((p/o+1)*(g+h))-a}}$(f).addMove(r,d);return this};Expedition.fn.move.htpocycMotion=function(h,j){var c=this.id,g,m,o,d,p,a,f,l;if(typeof(h)=="object"){p=Math.random();a=h}else{p=h;a=j}g=a.n;o=a.size||50;m=a.delta||1;d=(a.theta||0)*Math.PI/180;if(typeof(m)=="function"){a.x=function(r,q,n){l=Expedition.fn._lib.array.find(Expedition.canvas[c]._loop,function(s){if(s.id=="moveCanvasId"+h){s.currentTheta+=m(r,q,n)*Math.PI/180;return true}});f=l.currentTheta;return o*(Math.cos(d+f)+1/g*Math.cos(g*(d+f)))-q};a.y=function(r,q,n){l=Expedition.fn._lib.array.find(Expedition.canvas[c]._loop,function(s){if(s.id=="moveCanvasId"+h){s.currentTheta+=m(r,q,n)*Math.PI/180;return true}});f=l.currentTheta;return o*(Math.sin(d+f)-1/g*Math.sin(g*(d+f)))-n}}else{a.x=function(r,q,n){f=r*Math.PI/180/25*m;return o*(Math.cos(d+f)+1/g*Math.cos(g*(d+f)))-q};a.y=function(r,q,n){f=r*Math.PI/180/25*m;return o*(Math.sin(d+f)-1/g*Math.sin(g*(d+f)))-n}}$(c).addMove(p,a);return this};Expedition.fn.move.epicycMotion=function(h,j){var c=this.id,g,m,o,d,p,a,f,l;if(typeof(h)=="object"){p=Math.random();a=h}else{p=h;a=j}g=a.n;o=a.size||50;m=a.delta||1;d=(a.theta||0)*Math.PI/180;if(typeof(m)=="function"){a.x=function(r,q,n){l=Expedition.fn._lib.array.find(Expedition.canvas[c]._loop,function(s){if(s.id=="moveCanvasId"+h){s.currentTheta+=m(r,q,n)*Math.PI/180;return true}});f=l.currentTheta;return o*(Math.cos(d+f)+1/g*Math.cos(g*(d+f)))-q};a.y=function(r,q,n){l=Expedition.fn._lib.array.find(Expedition.canvas[c]._loop,function(s){if(s.id=="moveCanvasId"+h){s.currentTheta+=m(r,q,n)*Math.PI/180;return true}});f=l.currentTheta;return o*(Math.sin(d+f)+1/g*Math.sin(g*(d+f)))-n}}else{a.x=function(r,q,n){f=r*Math.PI/180/25*m;return o*(Math.cos(d+f)+1/g*Math.cos(g*(d+f)))-q};a.y=function(r,q,n){f=r*Math.PI/180/25*m;return o*(Math.sin(d+f)+1/g*Math.sin(g*(d+f)))-n}}$(c).addMove(p,a);return this};Expedition.fn.image=Expedition.fn.image||{};Expedition.fn.image.drawImage=function(f){var q,p,a,l,n,m,o,g,j=arguments,h=j.length,d=this.id,c=Expedition.fn.paint._getContext(d);if(h==3){q=j[1];p=j[2];c.drawImage(f,q,p)}else{if(h==5){q=j[1];p=j[2];a=j[3];l=j[4];c.drawImage(f,q,p,a,l)}else{if(h==9){n=j[1];m=j[2];o=j[3];g=j[4];q=j[5];p=j[6];a=j[7];l=j[8];c.drawImage(f,n,m,o,g,q,p,a,l)}}}return this};Expedition.fn.image.createImageData=function(c){var c=arguments,a=c.length,f=this.id,d=Expedition.fn.paint._getContext(f);if(a==1){return d.createImageData(c[0])}else{if(a==2){return d.createImageData(c[0],c[1])}}};Expedition.fn.image.getImageData=function(h,f,a,d){var g=this.id,c=Expedition.fn.paint._getContext(g);return c.getImageData(h,f,a,d)};Expedition.fn.image.putImageData=function(a,o,n,g,c,h,m){var l=arguments,j=l.length,f=this.id,d=Expedition.fn.paint._getContext(f),a,o,n,g,c,h,m;if(j==3){d.putImageData(a,o,n)}else{if(j==7){d.putImageData(a,o,n,g,c,h,m)}}return this};Expedition.fn.image.imageAntiColor=function(q,p,r,n){var c=this.id,f=Expedition.fn.paint._getNewCanvas(c),d=Expedition.fn.paint._getContext(c),q=q||0,p=p||0,r=r||f.width,n=n||f.height,a,l,o;if(typeof(q)=="number"){a=d.getImageData(q,p,r,n);l=a.data;o=l.length;for(var j=0;j<o;j+=4){l[j]=255-l[j];l[j+1]=255-l[j+1];l[j+2]=255-l[j+2]}d.putImageData(a,q,p)}else{if(typeof(q)=="function"){a=d.getImageData(0,0,f.width,f.height);l=a.data;o=l.length;for(var j=0;j<o;j+=4){var m=j/4%f.width,g=j/4/f.width;if(q(m,g,l[j],l[j+1],l[j+2],l[j+3])){l[j]=255-l[j];l[j+1]=255-l[j+1];l[j+2]=255-l[j+2]}}d.putImageData(a,0,0)}}return this};Expedition.fn.image.imagePixelate=function(s,p,m,q,A){var t=this.id,g=Expedition.fn.paint._getNewCanvas(t),c=Expedition.fn.paint._getContext(t),s=s||10,p=p||0,m=m||0,q=q||g.width,A=A||g.height,o=A/s,r=q/s,B=c.getImageData(p,m,q,A),D=B.data,z=D.length;c.save();c.translate(p,m);for(var v=0;v<r;v++){for(var u=0;u<o;u++){var f=u*s+s/2,d=v*s+s/2,C=Math.floor(d)*B.width*4+Math.floor(f)*4,l=D[C],n=D[C+1],a=D[C+2];c.save();c.fillStyle=Expedition.fn._lib.rgba(l,n,a,1);c.fillRect(f-s/2,d-s/2,s,s);c.restore()}}c.restore();return this};Expedition.fn.image.imagePixelParticle=function(s,p,m,q,A){var t=this.id,g=Expedition.fn.paint._getNewCanvas(t),c=Expedition.fn.paint._getContext(t),s=s||10,p=p||0,m=m||0,q=q||g.width,A=A||g.height,o=A/s,r=q/s,B=c.getImageData(p,m,q,A),D=B.data,z=D.length;c.save();c.translate(p,m);c.clearRect(p,m,q,A);for(var v=0;v<r;v++){for(var u=0;u<o;u++){var f=u*s+s/2,d=v*s+s/2,C=Math.floor(d)*B.width*4+Math.floor(f)*4,l=D[C],n=D[C+1],a=D[C+2];c.save();c.fillStyle=Expedition.fn._lib.rgba(l,n,a,1);c.beginPath();c.arc(f,d,s/2,0,Math.PI*2,false);c.closePath();c.fill();c.restore()}}c.restore();return this};Expedition.fn.image.imageGrey=function(r,q,s,o){var d=this.id,g=Expedition.fn.paint._getNewCanvas(d),f=Expedition.fn.paint._getContext(d),r=r||0,q=q||0,s=s||g.width,o=o||g.height,a,m,p,c;if(typeof(r)=="number"){a=f.getImageData(r,q,s,o);m=a.data;p=m.length;for(var l=0;l<p;l+=4){c=(m[l]+m[l+1]+m[l+2])/3;m[l]=c;m[l+1]=c;m[l+2]=c}f.putImageData(a,r,q)}else{if(typeof(r)=="function"){a=f.getImageData(0,0,g.width,g.height);m=a.data;p=m.length;for(var l=0;l<p;l+=4){var n=l/4%g.width,j=l/4/g.width;if(r(n,j,m[l],m[l+1],m[l+2],m[l+3])){c=(m[l]+m[l+1]+m[l+2])/3;m[l]=c;m[l+1]=c;m[l+2]=c}}f.putImageData(a,0,0)}}return this};Expedition.fn.image.imageMosaics=function(r,q,p,s,n){var a=this.id,d=Expedition.fn.paint._getNewCanvas(a),c=Expedition.fn.paint._getContext(a),r=r||10,q=q||0,p=p||0,s=s||d.width,n=n||d.height,t=n/r,o=s/r;c.save();c.translate(q,p);for(var l=0;l<t;l++){for(var f=0;f<o;f++){var m=f*r+r/2,g=l*r+r/2;c.save();c.fillStyle=Expedition.fn._lib.random.randomRgba(0,255,1);c.fillRect(m-r/2,g-r/2,r,r);c.restore()}}c.restore();return this};Expedition.fn.image.imageFilterRed=function(q,p,r,n){var c=this.id,f=Expedition.fn.paint._getNewCanvas(c),d=Expedition.fn.paint._getContext(c),q=q||0,p=p||0,r=r||f.width,n=n||f.height,a,l,o;if(typeof(q)=="number"){a=d.getImageData(q,p,r,n);l=a.data;o=l.length;for(var j=0;j<o;j+=4){l[j+1]=0;l[j+2]=0}d.putImageData(a,q,p)}else{if(typeof(q)=="function"){a=d.getImageData(0,0,f.width,f.height);l=a.data;o=l.length;for(var j=0;j<o;j+=4){var m=j/4%f.width,g=j/4/f.width;if(q(m,g,l[j],l[j+1],l[j+2],l[j+3])){l[j+1]=0;l[j+2]=0}}d.putImageData(a,0,0)}}return this};Expedition.fn.image.imageFilterGreen=function(q,p,r,n){var c=this.id,f=Expedition.fn.paint._getNewCanvas(c),d=Expedition.fn.paint._getContext(c),q=q||0,p=p||0,r=r||f.width,n=n||f.height,a,l,o;if(typeof(q)=="number"){a=d.getImageData(q,p,r,n);l=a.data;o=l.length;for(var j=0;j<o;j+=4){l[j]=0;l[j+2]=0}d.putImageData(a,q,p)}else{if(typeof(q)=="function"){a=d.getImageData(0,0,f.width,f.height);l=a.data;o=l.length;for(var j=0;j<o;j+=4){var m=j/4%f.width,g=j/4/f.width;if(q(m,g,l[j],l[j+1],l[j+2],l[j+3])){l[j]=0;l[j+2]=0}}d.putImageData(a,0,0)}}return this};Expedition.fn.image.imageFilterBlue=function(q,p,r,n){var c=this.id,f=Expedition.fn.paint._getNewCanvas(c),d=Expedition.fn.paint._getContext(c),q=q||0,p=p||0,r=r||f.width,n=n||f.height,a,l,o;if(typeof(q)=="number"){a=d.getImageData(q,p,r,n);l=a.data;o=l.length;for(var j=0;j<o;j+=4){l[j+1]=0;l[j]=0}d.putImageData(a,q,p)}else{if(typeof(q)=="function"){a=d.getImageData(0,0,f.width,f.height);l=a.data;o=l.length;for(var j=0;j<o;j+=4){var m=j/4%f.width,g=j/4/f.width;if(q(m,g,l[j],l[j+1],l[j+2],l[j+3])){l[j+1]=0;l[j]=0}}d.putImageData(a,0,0)}}return this};Expedition.fn.image.imageBlockRed=function(q,p,r,n){var c=this.id,f=Expedition.fn.paint._getNewCanvas(c),d=Expedition.fn.paint._getContext(c),q=q||0,p=p||0,r=r||f.width,n=n||f.height,a,l,o;if(typeof(q)=="number"){a=d.getImageData(q,p,r,n);l=a.data;o=l.length;for(var j=0;j<o;j+=4){l[j]=0}d.putImageData(a,q,p)}else{if(typeof(q)=="function"){a=d.getImageData(0,0,f.width,f.height);l=a.data;o=l.length;for(var j=0;j<o;j+=4){var m=j/4%f.width,g=j/4/f.width;if(q(m,g,l[j],l[j+1],l[j+2],l[j+3])){l[j]=0}}d.putImageData(a,0,0)}}return this};Expedition.fn.image.imageBlockGreen=function(q,p,r,n){var c=this.id,f=Expedition.fn.paint._getNewCanvas(c),d=Expedition.fn.paint._getContext(c),q=q||0,p=p||0,r=r||f.width,n=n||f.height,a,l,o;if(typeof(q)=="number"){a=d.getImageData(q,p,r,n);l=a.data;o=l.length;for(var j=0;j<o;j+=4){l[j+1]=0}d.putImageData(a,q,p)}else{if(typeof(q)=="function"){a=d.getImageData(0,0,f.width,f.height);l=a.data;o=l.length;for(var j=0;j<o;j+=4){var m=j/4%f.width,g=j/4/f.width;if(q(m,g,l[j],l[j+1],l[j+2],l[j+3])){l[j+1]=0}}d.putImageData(a,0,0)}}return this};Expedition.fn.image.imageBlockBlue=function(q,p,r,n){var c=this.id,f=Expedition.fn.paint._getNewCanvas(c),d=Expedition.fn.paint._getContext(c),q=q||0,p=p||0,r=r||f.width,n=n||f.height,a,l,o;if(typeof(q)=="number"){a=d.getImageData(q,p,r,n);l=a.data;o=l.length;for(var j=0;j<o;j+=4){l[j+2]=0}d.putImageData(a,q,p)}else{if(typeof(q)=="function"){a=d.getImageData(0,0,f.width,f.height);l=a.data;o=l.length;for(var j=0;j<o;j+=4){var m=j/4%f.width,g=j/4/f.width;if(q(m,g,l[j],l[j+1],l[j+2],l[j+3])){l[j+2]=0}}d.putImageData(a,0,0)}}return this};Expedition.fn.image.imageTransparent=function(r,s,q,t,o){var d=this.id,g=Expedition.fn.paint._getNewCanvas(d),f=Expedition.fn.paint._getContext(d),r=r||0,s=s||0,q=q||0,t=t||g.width,o=o||g.height,c,m,p;if(typeof(s)=="number"){c=f.getImageData(s,q,t,o);m=c.data;p=m.length;for(var l=0;l<p;l+=4){m[l+3]=r}f.putImageData(c,s,q)}else{if(typeof(s)=="function"){c=f.getImageData(0,0,g.width,g.height);m=c.data;p=m.length;for(var l=0;l<p;l+=4){var n=l/4%g.width,j=l/4/g.width;if(s(n,j,m[l],m[l+1],m[l+2],m[l+3])){m[l+3]=r}}f.putImageData(c,0,0)}}return this};Expedition.fn.image.backgroundImage=function(h){var a=this.id,f=Expedition.canvas[a]._canvas,d=$().getAttr(f,"id"),g,c,o=Expedition.fn.dom.getPosition(f),m=Expedition.fn.paint._getZIndex(f),j="backGroundCanvasId"+d,n=arguments,l=n.length;if(!$().g(j)){g=document.createElement("canvas");Expedition.fn.dom.setStyles(g,{position:"absolute",left:o.left+"px",top:o.top+"px","z-index":m==0?0:m-1});g.width=f.width;g.height=f.height;g.setAttribute("BaseCanvas",d);Expedition.fn.dom.setAttr(g,"index",m-1);Expedition.fn.dom.setAttr(g,"id",j);Expedition.fn.dom.insertBefore(g,f)}c=$().g(j).getContext("2d");if(l==3){dx=n[1];dy=n[2];c.drawImage(h,dx,dy)}else{if(l==5){dx=n[1];dy=n[2];dw=n[3];dh=n[4];c.drawImage(h,dx,dy,dw,dh)}else{if(l==9){sx=n[1];sy=n[2];sw=n[3];sh=n[4];dx=n[5];dy=n[6];dw=n[7];dh=n[8];c.drawImage(h,sx,sy,sw,sh,dx,dy,dw,dh)}}}return this};Expedition.fn.image.closeBackgroundImage=function(){var f=this.id,c=Expedition.fn.paint._getCanvas(f),d=$().getAttr(c,"id"),a="backGroundCanvasId"+d;if($().g(a)){Expedition.fn.dom.remove($().g(a))}return this};Expedition.fn.image._drawStampHandle=function(w,H,u,A){var j=Expedition.fn.paint._getNewCanvas(w),f=j.getContext("2d"),D,o,z=j.width,s=j.height,c,a,t,r,v,F,p=0,n=0,q=z,C=s,d=arguments,B=d.length;if(B==6){p=d[4];n=d[5];f.drawImage(u,p,n)}else{if(B==8){p=d[4];n=d[5];q=d[6];C=d[7];f.drawImage(u,p,n,q,C)}else{if(B==12){t=d[4];r=d[5];v=d[6];F=d[7];p=d[8];n=d[9];q=d[10];C=d[11];f.drawImage(u,t,r,v,F,p,n,q,C)}}}c=f.getImageData(p,n,q,C);if(typeof(H)=="function"){for(var l=n;l<C;l++){for(var m=p;m<q;m++){var h=m-p,g=l-n,G=Math.floor((g*q+h)*4);if(H(m,l)!=A){c.data[G]=0;c.data[G+1]=0;c.data[G+2]=0;c.data[G+3]=0}}}}else{D=Expedition.fn.paint._getNewCanvas(H);o=D.getContext("2d");a=o.getImageData(p,n,q,C);for(var l=n;l<C;l++){for(var m=p;m<q;m++){var h=m-p,g=l-n,G=Math.floor((g*q+h)*4),E=false;if(a.data[G]!=0||a.data[G+1]!=0||a.data[G+2]!=0||a.data[G+3]!=0){E=true}if(E!=A){c.data[G]=0;c.data[G+1]=0;c.data[G+2]=0;c.data[G+3]=0}}}}f.clearRect(p,n,q,C);f.putImageData(c,p,n)};Expedition.fn.image.drawInside=function(h,d){var n,m,o,f,q,p,a,l,c=this.id||false,j=arguments,g=j.length;if(g==4){q=j[2];p=j[3];Expedition.fn.image._drawStampHandle(c,h,d,true,q,p)}else{if(g==6){q=j[2];p=j[3];a=j[4];l=j[5];Expedition.fn.image._drawStampHandle(c,h,d,true,q,p,a,l)}else{if(g==10){n=j[2];m=j[3];o=j[4];f=j[5];q=j[6];p=j[7];a=j[8];l=j[9];Expedition.fn.image._drawStampHandle(c,h,d,true,n,m,o,f,q,p,a,l)}}}return this};Expedition.fn.image.drawOutside=function(h,d){var n,m,o,f,q,p,a,l,c=this.id||false,j=arguments,g=j.length;if(g==4){q=j[2];p=j[3];Expedition.fn.image._drawStampHandle(c,h,d,false,q,p)}else{if(g==6){q=j[2];p=j[3];a=j[4];l=j[5];Expedition.fn.image._drawStampHandle(c,h,d,false,q,p,a,l)}else{if(g==10){n=j[2];m=j[3];o=j[4];f=j[5];q=j[6];p=j[7];a=j[8];l=j[9];Expedition.fn.image._drawStampHandle(c,h,d,false,n,m,o,f,q,p,a,l)}}}return this};Expedition.fn.video=Expedition.fn.video||{};Expedition.fn.video.drawVideo=function(f,u,t,a,p,r,q,s,m){var d=this.id,h=Expedition.fn.paint._getNewCanvas(d),c=h.getContext("2d"),l,o=arguments,g,n=o.length;l=setInterval(function(){if(n==3){c.drawImage(f,u,t)}else{if(n==5){c.drawImage(f,u,t,a,p)}else{if(n==9){c.drawImage(f,u,t,a,p,r,q,s,m)}}}},40);if(this._loop){for(var j=0;j<this._loop.length;j++){if(this._loop[j].loop){clearInterval(this._loop[j].loop)}if(this._loop[j].id!="canvasId"+d){Expedition.fn.dom.remove($().g(this._loop[j].id))}}}this._loop=[];this._loop[this._loop.length]={loop:l,type:"video",id:"canvasId"+d};if(!d){g=$().getAttr(h,"id");$().setAttr(h,"BaseCanvas",g)}return this};Expedition.fn.video.stopVideo=function(){var d=this.id,c=Expedition.canvas[d]._loop||[],a=c[0].loop;if(a){clearInterval(a)}return this};Expedition.fn.video._videoHandlerCanvas=function(g,j){var f=document.createElement("canvas"),c=$().g(g),h,a,d=c.getAttribute("BaseCanvas");if(c){f.setAttribute("id",j);f.setAttribute("BaseCanvas",d);h=Expedition.fn.dom.getPosition(c);a=Expedition.fn.paint._getZIndex(c);Expedition.fn.dom.insertAfter(f,c);Expedition.fn.dom.setStyles(f,{position:"absolute",left:h.left+"px",top:h.top+"px","z-index":a});f.width=c.width;f.height=c.height}return f};Expedition.fn.video._makeVideoIdNum=function(f,d){var g=f._loop,a=g.length,c="handlerCanvasId"+d;while(a--){if(g[a].type==d){return parseInt(g[a].id.replace(c,""))+1}}return 1};Expedition.fn.video.videoAntiColor=function(n,g,o,t){var q=this.id,p=Expedition.canvas[q]._loop,f=p.length,r=p[f-1].id,A=$().g(r),u=A.getContext("2d"),c=Expedition.fn.paint._getCanvas(q),n=n||0,g=g||0,o=o||c.width,t=t||c.height,d,j,v,B,s,z,m="handlerCanvasIdAntiColor",l=Expedition.fn.video._makeVideoIdNum(this,"AntiColor");d=Expedition.fn.video._videoHandlerCanvas(r,m+l);j=d.getContext("2d");Expedition.fn.dom.setStyle(A,"display","none");var a=function(){var h=Expedition.canvas[q]._loop;for(var x=0;x<h.length;x++){if(h[x].id==m+l){u=$().g(h[x].pre).getContext("2d")}}if(typeof(n)=="number"){v=u.getImageData(0,0,c.width,c.height);B=v.data;s=B.length;for(var C=0;C<s;C+=4){var y=C/4%c.width,w=C/4/c.width;if(y>=n&&y<=n+o&&w>=g&&w<=g+t){B[C]=255-B[C];B[C+1]=255-B[C+1];B[C+2]=255-B[C+2]}}j.putImageData(v,0,0)}else{if(typeof(n)=="function"){v=u.getImageData(0,0,c.width,c.height);B=v.data;s=B.length;for(var C=0;C<s;C+=4){var y=C/4%c.width,w=C/4/c.width;if(n(y,w,B[C],B[C+1],B[C+2],B[C+3])){B[C]=255-B[C];B[C+1]=255-B[C+1];B[C+2]=255-B[C+2]}}j.putImageData(v,0,0)}}};z=setInterval(a,40);this._loop=this._loop||[];this._loop[this._loop.length]={loop:z,type:"AntiColor",id:m+l,pre:r};return this};Expedition.fn.video.stopVideoAntiColor=function(d){var l=this.id,j=Expedition.canvas[l]._loop,h,a=j.length,g,c="handlerCanvasIdAntiColor";if(d){for(var f=0;f<a;f++){if(j[f].id==c+d){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.id==c+d})}else{for(var f=0;f<a;f++){if(j[f].type=="AntiColor"){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.type=="AntiColor"})}return this};Expedition.fn.video.videoPixelate=function(q,n,g,o,u){var r=this.id,p=Expedition.canvas[r]._loop,f=p.length,s=p[f-1].id,B=$().g(s),v=B.getContext("2d"),c=Expedition.fn.paint._getCanvas(r),q=q||10,n=n||0,g=g||0,o=o||c.width,u=u||c.height,d,j,z,C,t,A,m="handlerCanvasIdPixelate",l=Expedition.fn.video._makeVideoIdNum(this,"Pixelate");d=Expedition.fn.video._videoHandlerCanvas(s,m+l);j=d.getContext("2d");Expedition.fn.dom.setStyle(B,"display","none");var a=function(){var H=Expedition.canvas[r]._loop;for(var y=0;y<H.length;y++){if(H[y].id==m+l){v=$().g(H[y].pre).getContext("2d")}}if(typeof(n)=="number"){z=v.getImageData(0,0,c.width,c.height);var L=o/q,I=u/q,K=v.getImageData(n,g,o,u),x=K.data;j.putImageData(z,0,0);j.save();j.translate(n,g);for(var E=0;E<I;E++){for(var y=0;y<L;y++){var G=y*q+q/2,D=E*q+q/2,F=Math.floor(D)*K.width*4+Math.floor(G)*4,h=x[F],w=x[F+1],J=x[F+2];j.save();j.fillStyle=Expedition.fn._lib.rgba(h,w,J,1);j.fillRect(G-q/2,D-q/2,q,q);j.restore()}}j.restore()}};A=setInterval(a,40);this._loop=this._loop||[];this._loop[this._loop.length]={loop:A,type:"Pixelate",id:m+l,pre:s};return this};Expedition.fn.video.stopVideoPixelate=function(d){var l=this.id,j=Expedition.canvas[l]._loop,h,a=j.length,g,c="handlerCanvasIdPixelate";if(d){for(var f=0;f<a;f++){if(j[f].id==c+d){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.id==c+d})}else{for(var f=0;f<a;f++){if(j[f].type=="Pixelate"){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.type=="Pixelate"})}return this};Expedition.fn.video.backgroundVideo=function(t,j,h,l,u,n,m,o,x){var p=this.id,d=Expedition.fn.paint._getCanvas(p),s=$().getAttr(d,"id"),c,v,q,f=Expedition.fn.dom.getPosition(d),g=Expedition.fn.paint._getZIndex(d),a=arguments,r=a.length,w="backGroundVideoCanvasId"+s;if(!$().g(w)){q=document.createElement("canvas");Expedition.fn.dom.setStyles(q,{position:"absolute",left:f.left+"px",top:f.top+"px","z-index":g-1});q.width=d.width;q.height=d.height;q.setAttribute("BaseCanvas",s);Expedition.fn.dom.setAttr(q,"index",g-1);Expedition.fn.dom.setAttr(q,"id",w);Expedition.fn.dom.setAttr(q,"loop",v);Expedition.fn.dom.insertBefore(q,d)}c=$().g(w).getContext("2d");v=setInterval(function(){if(r==3){c.drawImage(t,j,h)}else{if(r==5){c.drawImage(t,j,h,l,u)}else{if(r==9){c.drawImage(t,j,h,l,u,n,m,o,x)}}}},40);this._otherLoop=this._otherLoop||{};this._otherLoop.backgroundLoop=v;return this};Expedition.fn.video.closeBackgroundVideo=function(){var g=this.id,d=Expedition.fn.paint._getCanvas(g),f=$().getAttr(d,"id"),c="backGroundVideoCanvasId"+f,a=this._otherLoop;if($().g(c)){if(a&&a.backgroundLoop){clearInterval(a.backgroundLoop)}Expedition.fn.dom.remove($().g(c))}return this};Expedition.fn.video.videoGrey=function(o,j,p,u){var r=this.id,q=Expedition.canvas[r]._loop,g=q.length,s=q[g-1].id,B=$().g(s),v=B.getContext("2d"),d=Expedition.fn.paint._getCanvas(r),o=o||0,j=j||0,p=p||d.width,u=u||d.height,f,l,z,C,t,A,n="handlerCanvasIdGrey",c,m=Expedition.fn.video._makeVideoIdNum(this,"Grey");f=Expedition.fn.video._videoHandlerCanvas(s,n+m);l=f.getContext("2d");Expedition.fn.dom.setStyle(B,"display","none");var a=function(){var h=Expedition.canvas[r]._loop;for(var x=0;x<h.length;x++){if(h[x].id==n+m){v=$().g(h[x].pre).getContext("2d")}}if(typeof(o)=="number"){z=v.getImageData(0,0,d.width,d.height);C=z.data;t=C.length;for(var D=0;D<t;D+=4){var y=D/4%d.width,w=D/4/d.width;if(y>=o&&y<=o+p&&w>=j&&w<=j+u){c=(C[D]+C[D+1]+C[D+2])/3;C[D]=c;C[D+1]=c;C[D+2]=c}}l.putImageData(z,0,0)}else{if(typeof(o)=="function"){z=v.getImageData(0,0,d.width,d.height);C=z.data;t=C.length;for(var D=0;D<t;D+=4){var y=D/4%d.width,w=D/4/d.width;if(o(y,w,C[D],C[D+1],C[D+2],C[D+3])){c=(C[D]+C[D+1]+C[D+2])/3;C[D]=c;C[D+1]=c;C[D+2]=c}}l.putImageData(z,0,0)}}};A=setInterval(a,40);this._loop=this._loop||[];this._loop[this._loop.length]={loop:A,type:"Grey",id:n+m,pre:s};return this};Expedition.fn.video.stopVideoGrey=function(d){var l=this.id,j=Expedition.canvas[l]._loop,h,a=j.length,g,c="handlerCanvasIdGrey";if(d){for(var f=0;f<a;f++){if(j[f].id==c+d){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.id==c+d})}else{for(var f=0;f<a;f++){if(j[f].type=="Grey"){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.type=="Grey"})}return this};Expedition.fn.video.videoPixelParticle=function(q,n,g,o,u){var r=this.id,p=Expedition.canvas[r]._loop,f=p.length,s=p[f-1].id,B=$().g(s),v=B.getContext("2d"),c=Expedition.fn.paint._getCanvas(r),q=q||10,n=n||0,g=g||0,o=o||c.width,u=u||c.height,d,j,z,C,t,A,m="handlerCanvasIdPixelParticle",l=Expedition.fn.video._makeVideoIdNum(this,"PixelParticle");d=Expedition.fn.video._videoHandlerCanvas(s,m+l);j=d.getContext("2d");Expedition.fn.dom.setStyle(B,"display","none");var a=function(){var H=Expedition.canvas[r]._loop;for(var y=0;y<H.length;y++){if(H[y].id==m+l){v=$().g(H[y].pre).getContext("2d")}}if(typeof(n)=="number"){z=v.getImageData(0,0,c.width,c.height);var L=o/q,I=u/q,K=v.getImageData(n,g,o,u),x=K.data;j.putImageData(z,0,0);j.clearRect(n,g,o,u);j.save();j.translate(n,g);for(var E=0;E<I;E++){for(var y=0;y<L;y++){var G=y*q+q/2,D=E*q+q/2,F=Math.floor(D)*K.width*4+Math.floor(G)*4,h=x[F],w=x[F+1],J=x[F+2];j.save();j.fillStyle=Expedition.fn._lib.rgba(h,w,J,1);j.beginPath();j.arc(G,D,q/2,0,Math.PI*2,false);j.closePath();j.fill();j.restore()}}j.restore()}};A=setInterval(a,40);this._loop=this._loop||[];this._loop[this._loop.length]={loop:A,type:"PixelParticle",id:m+l,pre:s};return this};Expedition.fn.video.stopVideoPixelParticle=function(d){var l=this.id,j=Expedition.canvas[l]._loop,h,a=j.length,g,c="handlerCanvasIdPixelParticle";if(d){for(var f=0;f<a;f++){if(j[f].id==c+d){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.id==c+d})}else{for(var f=0;f<a;f++){if(j[f].type=="PixelParticle"){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.type=="PixelParticle"})}return this};Expedition.fn.video.videoFilterRed=function(n,g,o,t){var q=this.id,p=Expedition.canvas[q]._loop,f=p.length,r=p[f-1].id,A=$().g(r),u=A.getContext("2d"),c=Expedition.fn.paint._getCanvas(q),n=n||0,g=g||0,o=o||c.width,t=t||c.height,d,j,v,B,s,z,m="handlerCanvasIdFilterRed",l=Expedition.fn.video._makeVideoIdNum(this,"FilterRed");d=Expedition.fn.video._videoHandlerCanvas(r,m+l);j=d.getContext("2d");Expedition.fn.dom.setStyle(A,"display","none");var a=function(){var h=Expedition.canvas[q]._loop;for(var x=0;x<h.length;x++){if(h[x].id==m+l){u=$().g(h[x].pre).getContext("2d")}}if(typeof(n)=="number"){v=u.getImageData(0,0,c.width,c.height);B=v.data;s=B.length;for(var C=0;C<s;C+=4){var y=C/4%c.width,w=C/4/c.width;if(y>=n&&y<=n+o&&w>=g&&w<=g+t){B[C+1]=0;B[C+2]=0}}j.putImageData(v,0,0)}else{if(typeof(n)=="function"){v=u.getImageData(0,0,c.width,c.height);B=v.data;s=B.length;for(var C=0;C<s;C+=4){var y=C/4%c.width,w=C/4/c.width;if(n(y,w,B[C],B[C+1],B[C+2],B[C+3])){B[C+1]=0;B[C+2]=0}}j.putImageData(v,0,0)}}};z=setInterval(a,40);this._loop=this._loop||[];this._loop[this._loop.length]={loop:z,type:"FilterRed",id:m+l,pre:r};return this};Expedition.fn.video.stopVideoFilterRed=function(d){var l=this.id,j=Expedition.canvas[l]._loop,h,a=j.length,g,c="handlerCanvasIdFilterRed";if(d){for(var f=0;f<a;f++){if(j[f].id==c+d){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.id==c+d})}else{for(var f=0;f<a;f++){if(j[f].type=="FilterRed"){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.type=="FilterRed"})}return this};Expedition.fn.video.videoFilterGreen=function(n,g,o,t){var q=this.id,p=Expedition.canvas[q]._loop,f=p.length,r=p[f-1].id,A=$().g(r),u=A.getContext("2d"),c=Expedition.fn.paint._getCanvas(q),n=n||0,g=g||0,o=o||c.width,t=t||c.height,d,j,v,B,s,z,m="handlerCanvasIdFilterGreen",l=Expedition.fn.video._makeVideoIdNum(this,"FilterGreen");d=Expedition.fn.video._videoHandlerCanvas(r,m+l);j=d.getContext("2d");Expedition.fn.dom.setStyle(A,"display","none");var a=function(){var h=Expedition.canvas[q]._loop;for(var x=0;x<h.length;x++){if(h[x].id==m+l){u=$().g(h[x].pre).getContext("2d")}}if(typeof(n)=="number"){v=u.getImageData(0,0,c.width,c.height);B=v.data;s=B.length;for(var C=0;C<s;C+=4){var y=C/4%c.width,w=C/4/c.width;if(y>=n&&y<=n+o&&w>=g&&w<=g+t){B[C]=0;B[C+2]=0}}j.putImageData(v,0,0)}else{if(typeof(n)=="function"){v=u.getImageData(0,0,c.width,c.height);B=v.data;s=B.length;for(var C=0;C<s;C+=4){var y=C/4%c.width,w=C/4/c.width;if(n(y,w,B[C],B[C+1],B[C+2],B[C+3])){B[C]=0;B[C+2]=0}}j.putImageData(v,0,0)}}};z=setInterval(a,40);this._loop=this._loop||[];this._loop[this._loop.length]={loop:z,type:"FilterGreen",id:m+l,pre:r};return this};Expedition.fn.video.stopVideoFilterGreen=function(d){var l=this.id,j=Expedition.canvas[l]._loop,h,a=j.length,g,c="handlerCanvasIdFilterGreen";if(d){for(var f=0;f<a;f++){if(j[f].id==c+d){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.id==c+d})}else{for(var f=0;f<a;f++){if(j[f].type=="FilterGreen"){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.type=="FilterGreen"})}return this};Expedition.fn.video.videoFilterBlue=function(n,g,o,t){var q=this.id,p=Expedition.canvas[q]._loop,f=p.length,r=p[f-1].id,A=$().g(r),u=A.getContext("2d"),c=Expedition.fn.paint._getCanvas(q),n=n||0,g=g||0,o=o||c.width,t=t||c.height,d,j,v,B,s,z,m="handlerCanvasIdFilterBlue",l=Expedition.fn.video._makeVideoIdNum(this,"FilterBlue");d=Expedition.fn.video._videoHandlerCanvas(r,m+l);j=d.getContext("2d");Expedition.fn.dom.setStyle(A,"display","none");var a=function(){var h=Expedition.canvas[q]._loop;for(var x=0;x<h.length;x++){if(h[x].id==m+l){u=$().g(h[x].pre).getContext("2d")}}if(typeof(n)=="number"){v=u.getImageData(0,0,c.width,c.height);B=v.data;s=B.length;for(var C=0;C<s;C+=4){var y=C/4%c.width,w=C/4/c.width;if(y>=n&&y<=n+o&&w>=g&&w<=g+t){B[C+1]=0;B[C]=0}}j.putImageData(v,0,0)}else{if(typeof(n)=="function"){v=u.getImageData(0,0,c.width,c.height);B=v.data;s=B.length;for(var C=0;C<s;C+=4){var y=C/4%c.width,w=C/4/c.width;if(n(y,w,B[C],B[C+1],B[C+2],B[C+3])){B[C+1]=0;B[C]=0}}j.putImageData(v,0,0)}}};z=setInterval(a,40);this._loop=this._loop||[];this._loop[this._loop.length]={loop:z,type:"FilterBlue",id:m+l,pre:r};return this};Expedition.fn.video.stopVideoFilterBlue=function(d){var l=this.id,j=Expedition.canvas[l]._loop,h,a=j.length,g,c="handlerCanvasIdFilterBlue";if(d){for(var f=0;f<a;f++){if(j[f].id==c+d){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.id==c+d})}else{for(var f=0;f<a;f++){if(j[f].type=="FilterBlue"){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.type=="FilterBlue"})}return this};Expedition.fn.video.videoMosaics=function(q,n,g,o,u){var r=this.id,p=Expedition.canvas[r]._loop,f=p.length,s=p[f-1].id,B=$().g(s),v=B.getContext("2d"),c=Expedition.fn.paint._getCanvas(r),q=q||10,n=n||0,g=g||0,o=o||c.width,u=u||c.height,d,j,z,C,t,A,m="handlerCanvasIdMosaics",l=Expedition.fn.video._makeVideoIdNum(this,"Mosaics");d=Expedition.fn.video._videoHandlerCanvas(s,m+l);j=d.getContext("2d");Expedition.fn.dom.setStyle(B,"display","none");var a=function(){var H=Expedition.canvas[r]._loop;for(var y=0;y<H.length;y++){if(H[y].id==m+l){v=$().g(H[y].pre).getContext("2d")}}if(typeof(n)=="number"){z=v.getImageData(0,0,c.width,c.height);var L=o/q,I=u/q,K=v.getImageData(n,g,o,u),x=K.data;j.putImageData(z,0,0);j.clearRect(n,g,o,u);j.save();j.translate(n,g);for(var E=0;E<L;E++){for(var y=0;y<I;y++){var G=y*q+q/2,D=E*q+q/2,F=Math.floor(D)*K.width*4+Math.floor(G)*4,h=x[F],w=x[F+1],J=x[F+2];j.save();j.fillStyle=Expedition.fn._lib.random.randomRgba(0,255,1);j.fillRect(G-q/2,D-q/2,q,q);j.restore()}}j.restore()}};A=setInterval(a,40);this._loop=this._loop||[];this._loop[this._loop.length]={loop:A,type:"Mosaics",id:m+l,pre:s};return this};Expedition.fn.video.stopVideoMosaics=function(d){var l=this.id,j=Expedition.canvas[l]._loop,h,a=j.length,g,c="handlerCanvasIdMosaics";if(d){for(var f=0;f<a;f++){if(j[f].id==c+d){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.id==c+d})}else{for(var f=0;f<a;f++){if(j[f].type=="Mosaics"){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.type=="Mosaics"})}return this};Expedition.fn.video.videoBlockRed=function(n,g,o,t){var q=this.id,p=Expedition.canvas[q]._loop,f=p.length,r=p[f-1].id,A=$().g(r),u=A.getContext("2d"),c=Expedition.fn.paint._getCanvas(q),n=n||0,g=g||0,o=o||c.width,t=t||c.height,d,j,v,B,s,z,m="handlerCanvasIdBlockRed",l=Expedition.fn.video._makeVideoIdNum(this,"BlockRed");d=Expedition.fn.video._videoHandlerCanvas(r,m+l);j=d.getContext("2d");Expedition.fn.dom.setStyle(A,"display","none");var a=function(){var h=Expedition.canvas[q]._loop;for(var x=0;x<h.length;x++){if(h[x].id==m+l){u=$().g(h[x].pre).getContext("2d")}}if(typeof(n)=="number"){v=u.getImageData(0,0,c.width,c.height);B=v.data;s=B.length;for(var C=0;C<s;C+=4){var y=C/4%c.width,w=C/4/c.width;if(y>=n&&y<=n+o&&w>=g&&w<=g+t){B[C]=0}}j.putImageData(v,0,0)}else{if(typeof(n)=="function"){v=u.getImageData(0,0,c.width,c.height);B=v.data;s=B.length;for(var C=0;C<s;C+=4){var y=C/4%c.width,w=C/4/c.width;if(n(y,w,B[C],B[C+1],B[C+2],B[C+3])){B[C]=0}}j.putImageData(v,0,0)}}};z=setInterval(a,40);this._loop=this._loop||[];this._loop[this._loop.length]={loop:z,type:"BlockRed",id:m+l,pre:r};return this};Expedition.fn.video.stopVideoBlockRed=function(d){var l=this.id,j=Expedition.canvas[l]._loop,h,a=j.length,g,c="handlerCanvasIdBlockRed";if(d){for(var f=0;f<a;f++){if(j[f].id==c+d){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.id==c+d})}else{for(var f=0;f<a;f++){if(j[f].type=="BlockRed"){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.type=="BlockRed"})}return this};Expedition.fn.video.videoBlockGreen=function(n,g,o,t){var q=this.id,p=Expedition.canvas[q]._loop,f=p.length,r=p[f-1].id,A=$().g(r),u=A.getContext("2d"),c=Expedition.fn.paint._getCanvas(q),n=n||0,g=g||0,o=o||c.width,t=t||c.height,d,j,v,B,s,z,m="handlerCanvasIdBlockGreen",l=Expedition.fn.video._makeVideoIdNum(this,"BlockGreen");d=Expedition.fn.video._videoHandlerCanvas(r,m+l);j=d.getContext("2d");Expedition.fn.dom.setStyle(A,"display","none");var a=function(){var h=Expedition.canvas[q]._loop;for(var x=0;x<h.length;x++){if(h[x].id==m+l){u=$().g(h[x].pre).getContext("2d")}}if(typeof(n)=="number"){v=u.getImageData(0,0,c.width,c.height);B=v.data;s=B.length;for(var C=0;C<s;C+=4){var y=C/4%c.width,w=C/4/c.width;if(y>=n&&y<=n+o&&w>=g&&w<=g+t){B[C+1]=0}}j.putImageData(v,0,0)}else{if(typeof(n)=="function"){v=u.getImageData(0,0,c.width,c.height);B=v.data;s=B.length;for(var C=0;C<s;C+=4){var y=C/4%c.width,w=C/4/c.width;if(n(y,w,B[C],B[C+1],B[C+2],B[C+3])){B[C+1]=0}}j.putImageData(v,0,0)}}};z=setInterval(a,40);this._loop=this._loop||[];this._loop[this._loop.length]={loop:z,type:"BlockGreen",id:m+l,pre:r};return this};Expedition.fn.video.stopVideoBlockGreen=function(d){var l=this.id,j=Expedition.canvas[l]._loop,h,a=j.length,g,c="handlerCanvasIdBlockGreen";if(d){for(var f=0;f<a;f++){if(j[f].id==c+d){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.id==c+d})}else{for(var f=0;f<a;f++){if(j[f].type=="BlockGreen"){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.type=="BlockGreen"})}return this};Expedition.fn.video.videoBlockBlue=function(n,g,o,t){var q=this.id,p=Expedition.canvas[q]._loop,f=p.length,r=p[f-1].id,A=$().g(r),u=A.getContext("2d"),c=Expedition.fn.paint._getCanvas(q),n=n||0,g=g||0,o=o||c.width,t=t||c.height,d,j,v,B,s,z,m="handlerCanvasIdBlockBlue",l=Expedition.fn.video._makeVideoIdNum(this,"BlockBlue");d=Expedition.fn.video._videoHandlerCanvas(r,m+l);j=d.getContext("2d");Expedition.fn.dom.setStyle(A,"display","none");var a=function(){var h=Expedition.canvas[q]._loop;for(var x=0;x<h.length;x++){if(h[x].id==m+l){u=$().g(h[x].pre).getContext("2d")}}if(typeof(n)=="number"){v=u.getImageData(0,0,c.width,c.height);B=v.data;s=B.length;for(var C=0;C<s;C+=4){var y=C/4%c.width,w=C/4/c.width;if(y>=n&&y<=n+o&&w>=g&&w<=g+t){B[C+1]=0}}j.putImageData(v,0,0)}else{if(typeof(n)=="function"){v=u.getImageData(0,0,c.width,c.height);B=v.data;s=B.length;for(var C=0;C<s;C+=4){var y=C/4%c.width,w=C/4/c.width;if(n(y,w,B[C],B[C+1],B[C+2],B[C+3])){B[C+1]=0}}j.putImageData(v,0,0)}}};z=setInterval(a,40);this._loop=this._loop||[];this._loop[this._loop.length]={loop:z,type:"BlockBlue",id:m+l,pre:r};return this};Expedition.fn.video.stopVideoBlockBlue=function(d){var l=this.id,j=Expedition.canvas[l]._loop,h,a=j.length,g,c="handlerCanvasIdBlockBlue";if(d){for(var f=0;f<a;f++){if(j[f].id==c+d){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.id==c+d})}else{for(var f=0;f<a;f++){if(j[f].type=="BlockBlue"){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.type=="BlockBlue"})}return this};Expedition.fn.video.videoTransparent=function(C,o,j,p,u){var r=this.id,q=Expedition.canvas[r]._loop,g=q.length,s=q[g-1].id,B=$().g(s),v=B.getContext("2d"),d=Expedition.fn.paint._getCanvas(r),C=C||0,o=o||0,j=j||0,p=p||d.width,u=u||d.height,f,l,z,D,t,A,n="handlerCanvasIdTransparent",m=Expedition.fn.video._makeVideoIdNum(this,"Transparent");f=Expedition.fn.video._videoHandlerCanvas(s,n+m);l=f.getContext("2d");Expedition.fn.dom.setStyle(B,"display","none");var c=function(){var a=Expedition.canvas[r]._loop;for(var w=0;w<a.length;w++){if(a[w].id==n+m){v=$().g(a[w].pre).getContext("2d")}}if(typeof(o)=="number"){z=v.getImageData(0,0,d.width,d.height);D=z.data;t=D.length;for(var y=0;y<t;y+=4){var x=y/4%d.width,h=y/4/d.width;if(x>=o&&x<=o+p&&h>=j&&h<=j+u){D[y+3]=C}}l.putImageData(z,0,0)}else{if(typeof(o)=="function"){z=v.getImageData(0,0,d.width,d.height);D=z.data;t=D.length;for(var y=0;y<t;y+=4){var x=y/4%d.width,h=y/4/d.width;if(o(x,h,D[y],D[y+1],D[y+2],D[y+3])){D[y+3]=C}}l.putImageData(z,0,0)}}};A=setInterval(c,40);this._loop=this._loop||[];this._loop[this._loop.length]={loop:A,type:"Transparent",id:n+m,pre:s};return this};Expedition.fn.video.stopVideoTransparent=function(d){var l=this.id,j=Expedition.canvas[l]._loop,h,a=j.length,g,c="handlerCanvasIdTransparent";if(d){for(var f=0;f<a;f++){if(j[f].id==c+d){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.id==c+d})}else{for(var f=0;f<a;f++){if(j[f].type=="Transparent"){g=j[f].pre;clearInterval(j[f].loop);if(f==a-1){h=Expedition.fn.dom.getStyle($().g(j[f].id),"display");Expedition.fn.dom.setStyle($().g(g),"display",h)}else{j[f+1].pre=g}Expedition.fn.dom.remove($().g(j[f].id))}}Expedition.fn._lib.array.remove(j,function(m){return m.type=="Transparent"})}return this};Expedition.fn.expand=function(a,c){Expedition.fn.init.prototype[a]=c};Expedition.fn.queue=Expedition.fn.queue||{};Expedition.fn.queue.startQueue=function(){this._queue=true;return this};Expedition.fn.queue.stopQueue=function(){this._queue=false;return this};Expedition.fn.event=Expedition.fn.event||{};Expedition.fn.event._addEvent=function(c,h,j){var j=j||{},a=j.eventIndex||0,n=j.isEventTransparent==false?false:true,m=j.fireEvent,d=j.isFireMove,l=j.unit,g=Expedition.fn.paint._getCanvas(this.id),f=Expedition.fn.dom.getAttr(g,"id"),c="on"+c.replace(/^on/i,"");if(this.id){if(!Expedition.canvas[this.id]._event){Expedition.canvas[this.id]._event=[]}Expedition.canvas[this.id]._event[Expedition.canvas[this.id]._event.length]={type:c,func:h,eventIndex:a,isEventTransparent:n,fireEvent:m,isFireMove:d,unit:l}}Expedition.canvas._event[Expedition.canvas._event.length]={type:c,func:h,id:this.id,canvasId:f,eventIndex:a,isEventTransparent:n,fireEvent:m,isFireMove:d,unit:l};return this};Expedition.fn.event._removeEvent=function(c,a){var d=this.id,c="on"+c.replace(/^on/i,"");if(d){Expedition.fn._lib.array.remove(Expedition.canvas[d]._event,function(f){return f.type==c&&(f.func==a||!a)});Expedition.fn._lib.array.remove(Expedition.canvas._event,function(f){return f.type==c&&(f.func==a||!a)&&f.id==d})}else{Expedition.fn._lib.array.remove(Expedition.canvas._event,function(f){return f.type==c&&(f.func==a||!a)})}return this};Expedition.fn.event.click=function(a,c){this.addEvent("onclick",a,c);return this};Expedition.fn.event.dblclick=function(a,c){this.addEvent("ondblclick",a,c);return this};Expedition.fn.event.contextmenu=function(a,c){this.addEvent("oncontextmenu",a,c);return this};Expedition.fn.event.mousedown=function(a,c){this.addEvent("onmousedown",a,c);return this};Expedition.fn.event.mousemove=function(a,c){this.addEvent("onmousemove",a,c);return this};Expedition.fn.event.mouseover=function(a,c){this.addEvent("onmouseover",a,c);return this};Expedition.fn.event.mouseup=function(a,c){this.addEvent("onmouseup",a,c);return this};Expedition.fn.event.keydown=function(a,c){this.addEvent("onkeydown",a,c);return this};Expedition.fn.event.keypress=function(a,c){this.addEvent("onkeypress",a,c);return this};Expedition.fn.event.keyup=function(a,c){this.addEvent("onkeyup",a,c);return this};Expedition.fn.event.touchstart=function(a,c){this.addEvent("ontouchstart",a,c);return this};Expedition.fn.event.touchmove=function(a,c){this.addEvent("ontouchmove",a,c);return this};Expedition.fn.event.touchend=function(a,c){this.addEvent("ontouchend",a,c);return this};Expedition.fn.event._addEventHandle=function(a){if(a){Expedition.fn.event.on(a,"click",Expedition.fn.event._clickHandle);Expedition.fn.event.on(a,"dblclick",Expedition.fn.event._dblclickHandle);Expedition.fn.event.on(a,"contextmenu",Expedition.fn.event._contextmenuHandle);Expedition.fn.event.on(a,"mousedown",Expedition.fn.event._mousedownHandle);Expedition.fn.event.on(a,"mousemove",Expedition.fn.event._mousemoveHandle);Expedition.fn.event.on(a,"mouseover",Expedition.fn.event._mouseoverHandle);Expedition.fn.event.on(a,"mouseout",Expedition.fn.event._mouseoutHandle);Expedition.fn.event.on(a,"mouseup",Expedition.fn.event._mouseupHandle);Expedition.fn.event.on(document,"keydown",Expedition.fn.event._keydownHandle);Expedition.fn.event.on(document,"keypress",Expedition.fn.event._keypressHandle);Expedition.fn.event.on(document,"keyup",Expedition.fn.event._keyupHandle);Expedition.fn.event.on(a,"touchstart",Expedition.fn.event._touchstartHandle);Expedition.fn.event.on(a,"touchmove",Expedition.fn.event._touchmoveHandle);Expedition.fn.event.on(a,"touchend",Expedition.fn.event._touchendHandle)}};Expedition.fn.event._isInObject=function(a,l,j,m){var f=Expedition.fn.paint._getNewCanvas(a),c=f.getContext("2d"),d,h,m=m;Expedition.canvas[a]._loop=Expedition.canvas[a]._loop||[];if(Expedition.canvas[a]._loop.length>0){f=$().g(Expedition.canvas[a]._loop[Expedition.canvas[a]._loop.length-1].id);c=f.getContext("2d")}if(m){d=c.getImageData(l-m/2,j-m/2,m,m)}else{d=c.getImageData(l,j,1,1)}h=d.data.length;for(var g=0;g<h;g++){if(d.data[g]!=0){return true}}return false};Expedition.fn.event._eventPriority=function(f,g){var c,a=true;if(f.length==0){return}c=f[0].eventIndex;f=f.sort(function(j,h){var m=j.eventIndex||0,l=h.eventIndex||0;return l-m});for(var d=0;d<f.length;d++){if(f[d].eventIndex<c&&a==false){return}else{f[d].func(g)}if(f[d].isEventTransparent==false){a=false}c=f[d].eventIndex}};Expedition.fn.event._clickHandle=function(v){var z=Expedition.canvas,j=Expedition.canvas._event,s=j.length,d,l,h=[],w=Expedition.fn.event.getTarget(v),t=Expedition.fn.dom.getAttr(w,"canvasId"),c=Expedition.fn.event.getPageX(v),a=Expedition.fn.event.getPageY(v),p=$().g(t).offsetLeft,u=$().g(t).offsetTop,n=c-p,m=a-u,q=false;for(var r=0;r<s;r++){if(j[r].type=="onclick"&&j[r].canvasId==t&&(j[r].id&&!Expedition.canvas[j[r].id].isHide||!j[r].id)){if(j[r].id){if(j[r].fireEvent){if(!j[r].isFireMove){q=j[r].fireEvent(n,m)}else{var g=0,f=0,o=j[r].id;Expedition.canvas[o]._loop=Expedition.canvas[o]._loop||[];if(Expedition.canvas[o]._loop.length>0){g=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].x;f=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].y}q=j[r].fireEvent(n-g,m-f)}}else{q=Expedition.fn.event._isInObject(j[r].id,n,m,j[r].unit)}if(q){h[h.length]=j[r]}}else{h[h.length]=j[r]}}}Expedition.fn.event._eventPriority(h,v)};Expedition.fn.event._dblclickHandle=function(v){var z=Expedition.canvas,j=Expedition.canvas._event,s=j.length,d,l,h=[],w=Expedition.fn.event.getTarget(v),t=Expedition.fn.dom.getAttr(w,"canvasId"),c=Expedition.fn.event.getPageX(v),a=Expedition.fn.event.getPageY(v),p=$().g(t).offsetLeft,u=$().g(t).offsetTop,n=c-p,m=a-u,q=false;for(var r=0;r<s;r++){if(j[r].type=="ondblclick"&&j[r].canvasId==t&&(j[r].id&&!Expedition.canvas[j[r].id].isHide||!j[r].id)){if(j[r].id){if(j[r].fireEvent){if(!j[r].isFireMove){q=j[r].fireEvent(n,m)}else{var g=0,f=0,o=j[r].id;Expedition.canvas[o]._loop=Expedition.canvas[o]._loop||[];if(Expedition.canvas[o]._loop.length>0){g=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].x;f=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].y}q=j[r].fireEvent(n-g,m-f)}}else{q=Expedition.fn.event._isInObject(j[r].id,n,m,j[r].unit)}if(q){h[h.length]=j[r]}}else{h[h.length]=j[r]}}}Expedition.fn.event._eventPriority(h,v)};Expedition.fn.event._contextmenuHandle=function(v){var z=Expedition.canvas,j=Expedition.canvas._event,s=j.length,d,l,h=[],w=Expedition.fn.event.getTarget(v),t=Expedition.fn.dom.getAttr(w,"canvasId"),c=Expedition.fn.event.getPageX(v),a=Expedition.fn.event.getPageY(v),p=$().g(t).offsetLeft,u=$().g(t).offsetTop,n=c-p,m=a-u,q=false;for(var r=0;r<s;r++){if(j[r].type=="oncontextmenu"&&j[r].canvasId==t&&(j[r].id&&!Expedition.canvas[j[r].id].isHide||!j[r].id)){if(j[r].id){if(j[r].fireEvent){if(!j[r].isFireMove){q=j[r].fireEvent(n,m)}else{var g=0,f=0,o=j[r].id;Expedition.canvas[o]._loop=Expedition.canvas[o]._loop||[];if(Expedition.canvas[o]._loop.length>0){g=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].x;f=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].y}q=j[r].fireEvent(n-g,m-f)}}else{q=Expedition.fn.event._isInObject(j[r].id,n,m,j[r].unit)}if(q){h[h.length]=j[r]}}else{h[h.length]=j[r]}}}Expedition.fn.event._eventPriority(h,v)};Expedition.fn.event._mousedownHandle=function(z){var B=Expedition.canvas,l=Expedition.canvas._event,u=l.length,d,m,h=[],A=Expedition.fn.event.getTarget(z),v=Expedition.fn.dom.getAttr(A,"canvasId"),c=Expedition.fn.event.getPageX(z),a=Expedition.fn.event.getPageY(z),q=$().g(v).offsetLeft,w=$().g(v).offsetTop,o=c-q,n=a-w,s=false;for(var t=0;t<u;t++){if(l[t].type=="onmousedown"&&l[t].canvasId==v&&(l[t].id&&!Expedition.canvas[l[t].id].isHide||!l[t].id)){if(l[t].id){if(l[t].fireEvent){if(!l[t].isFireMove){s=l[t].fireEvent(o,n)}else{var g=0,f=0,p=l[t].id;Expedition.canvas[p]._loop=Expedition.canvas[p]._loop||[];if(Expedition.canvas[p]._loop.length>0){for(var r=0;r<Expedition.canvas[p]._loop.length;r++){g+=Expedition.canvas[p]._loop[r].x;f+=Expedition.canvas[p]._loop[r].y}}s=l[t].fireEvent(o-g-Expedition.canvas[p]._x,n-f-Expedition.canvas[p]._y)}}else{s=Expedition.fn.event._isInObject(l[t].id,o,n,l[t].unit)}if(s){h[h.length]=l[t]}}else{h[h.length]=l[t]}}}Expedition.fn.event._eventPriority(h,z)};Expedition.fn.event._mousemoveHandle=function(v){var z=Expedition.canvas,j=Expedition.canvas._event,s=j.length,d,l,h=[],w=Expedition.fn.event.getTarget(v),t=Expedition.fn.dom.getAttr(w,"canvasId"),c=Expedition.fn.event.getPageX(v),a=Expedition.fn.event.getPageY(v),p=$().g(t).offsetLeft,u=$().g(t).offsetTop,n=c-p,m=a-u,q=false;for(var r=0;r<s;r++){if((j[r].type=="onmousemove"||j[r].type=="onmouseover"||j[r].type=="onmouseout")&&j[r].canvasId==t){if(j[r].id){if((j[r].type=="onmousemove"||j[r].type=="onmouseover")&&(j[r].id&&!Expedition.canvas[j[r].id].isHide||!j[r].id)){if(j[r].fireEvent){if(!j[r].isFireMove){q=j[r].fireEvent(n,m)}else{var g=0,f=0,o=j[r].id;Expedition.canvas[o]._loop=Expedition.canvas[o]._loop||[];if(Expedition.canvas[o]._loop.length>0){g=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].x;f=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].y}q=j[r].fireEvent(n-g,m-f)}}else{q=Expedition.fn.event._isInObject(j[r].id,n,m,j[r].unit)}}else{if(j[r].type=="onmouseout"&&(j[r].id&&!Expedition.canvas[j[r].id].isHide||!j[r].id)){if(j[r].fireEvent){if(!j[r].isFireMove){q=j[r].fireEvent(n,m)}else{var g=0,f=0,o=j[r].id;Expedition.canvas[o]._loop=Expedition.canvas[o]._loop||[];if(Expedition.canvas[o]._loop.length>0){g=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].x;f=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].y}q=j[r].fireEvent(n-g,m-f)}}else{q=!Expedition.fn.event._isInObject(j[r].id,n,m,j[r].unit)}}}if(q){h[h.length]=j[r]}}else{h[h.length]=j[r]}}}Expedition.fn.event._eventPriority(h,v)};Expedition.fn.event._mouseoverHandle=function(o){var h=Expedition.canvas,c=Expedition.canvas._event,n=c.length,a,t,m=[],p=Expedition.fn.event.getTarget(o),d=Expedition.fn.dom.getAttr(p,"canvasId"),j=Expedition.fn.event.getPageX(o),g=Expedition.fn.event.getPageY(o),f=$().g(d).offsetLeft,r=$().g(d).offsetTop,u=j-f,s=g-r,q=false;for(var l=0;l<n;l++){if(c[l].type=="onmouseover"&&c[l].canvasId==d&&(c[l].id&&!Expedition.canvas[c[l].id].isHide||!c[l].id)){if(!c[l].id){q=true}if(q){m[m.length]=c[l]}}}Expedition.fn.event._eventPriority(m,o)};Expedition.fn.event._mouseoutHandle=function(o){var h=Expedition.canvas,c=Expedition.canvas._event,n=c.length,a,t,m=[],p=Expedition.fn.event.getTarget(o),d=Expedition.fn.dom.getAttr(p,"canvasId"),j=Expedition.fn.event.getPageX(o),g=Expedition.fn.event.getPageY(o),f=$().g(d).offsetLeft,r=$().g(d).offsetTop,u=j-f,s=g-r,q=false;for(var l=0;l<n;l++){if(c[l].type=="onmouseout"&&c[l].canvasId==d&&(c[l].id&&!Expedition.canvas[c[l].id].isHide||!c[l].id)){if(!c[l].id){q=true}if(q){m[m.length]=c[l]}}}Expedition.fn.event._eventPriority(m,o)};Expedition.fn.event._mouseupHandle=function(v){var z=Expedition.canvas,j=Expedition.canvas._event,s=j.length,d,l,h=[],w=Expedition.fn.event.getTarget(v),t=Expedition.fn.dom.getAttr(w,"canvasId"),c=Expedition.fn.event.getPageX(v),a=Expedition.fn.event.getPageY(v),p=$().g(t).offsetLeft,u=$().g(t).offsetTop,n=c-p,m=a-u,q=false;for(var r=0;r<s;r++){if(j[r].type=="onmouseup"&&j[r].canvasId==t&&(j[r].id&&!Expedition.canvas[j[r].id].isHide||!j[r].id)){if(j[r].id){if(j[r].fireEvent){if(!j[r].isFireMove){q=j[r].fireEvent(n,m)}else{var g=0,f=0,o=j[r].id;Expedition.canvas[o]._loop=Expedition.canvas[o]._loop||[];if(Expedition.canvas[o]._loop.length>0){g=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].x;f=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].y}q=j[r].fireEvent(n-g,m-f)}}else{q=Expedition.fn.event._isInObject(j[r].id,n,m,j[r].unit)}if(q){h[h.length]=j[r]}}else{h[h.length]=j[r]}}}Expedition.fn.event._eventPriority(h,v)};Expedition.fn.event._touchstartHandle=function(v){var z=Expedition.canvas,j=Expedition.canvas._event,s=j.length,d,l,h=[],w=Expedition.fn.event.getTarget(v),t=Expedition.fn.dom.getAttr(w,"canvasId"),c=Expedition.fn.event.getPageX(v),a=Expedition.fn.event.getPageY(v),p=$().g(t).offsetLeft,u=$().g(t).offsetTop,n=c-p,m=a-u,q=false;for(var r=0;r<s;r++){if(j[r].type=="ontouchstart"&&j[r].canvasId==t&&(j[r].id&&!Expedition.canvas[j[r].id].isHide||!j[r].id)){if(j[r].id){if(j[r].fireEvent){if(!j[r].isFireMove){q=j[r].fireEvent(n,m)}else{var g=0,f=0,o=j[r].id;Expedition.canvas[o]._loop=Expedition.canvas[o]._loop||[];if(Expedition.canvas[o]._loop.length>0){g=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].x;f=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].y}q=j[r].fireEvent(n-g,m-f)}}else{q=Expedition.fn.event._isInObject(j[r].id,n,m,j[r].unit)}if(q){h[h.length]=j[r]}}else{h[h.length]=j[r]}}}Expedition.fn.event._eventPriority(h,v)};Expedition.fn.event._touchmoveHandle=function(v){var z=Expedition.canvas,j=Expedition.canvas._event,s=j.length,d,l,h=[],w=Expedition.fn.event.getTarget(v),t=Expedition.fn.dom.getAttr(w,"canvasId"),c=Expedition.fn.event.getPageX(v),a=Expedition.fn.event.getPageY(v),p=$().g(t).offsetLeft,u=$().g(t).offsetTop,n=c-p,m=a-u,q=false;for(var r=0;r<s;r++){if(j[r].type=="ontouchmove"&&j[r].canvasId==t&&(j[r].id&&!Expedition.canvas[j[r].id].isHide||!j[r].id)){if(j[r].id){if(j[r].fireEvent){if(!j[r].isFireMove){q=j[r].fireEvent(n,m)}else{var g=0,f=0,o=j[r].id;Expedition.canvas[o]._loop=Expedition.canvas[o]._loop||[];if(Expedition.canvas[o]._loop.length>0){g=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].x;f=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].y}q=j[r].fireEvent(n-g,m-f)}}else{q=Expedition.fn.event._isInObject(j[r].id,n,m,j[r].unit)}if(q){h[h.length]=j[r]}}else{h[h.length]=j[r]}}}Expedition.fn.event._eventPriority(h,v)};Expedition.fn.event._touchendHandle=function(v){var z=Expedition.canvas,j=Expedition.canvas._event,s=j.length,d,l,h=[],w=Expedition.fn.event.getTarget(v),t=Expedition.fn.dom.getAttr(w,"canvasId"),c=Expedition.fn.event.getPageX(v),a=Expedition.fn.event.getPageY(v),p=$().g(t).offsetLeft,u=$().g(t).offsetTop,n=c-p,m=a-u,q=false;for(var r=0;r<s;r++){if(j[r].type=="ontouchend"&&j[r].canvasId==t&&(j[r].id&&!Expedition.canvas[j[r].id].isHide||!j[r].id)){if(j[r].id){if(j[r].fireEvent){if(!j[r].isFireMove){q=j[r].fireEvent(n,m)}else{var g=0,f=0,o=j[r].id;Expedition.canvas[o]._loop=Expedition.canvas[o]._loop||[];if(Expedition.canvas[o]._loop.length>0){g=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].x;f=Expedition.canvas[o]._loop[Expedition.canvas[o]._loop.length-1].y}q=j[r].fireEvent(n-g,m-f)}}else{q=Expedition.fn.event._isInObject(j[r].id,n,m,j[r].unit)}if(q){h[h.length]=j[r]}}else{h[h.length]=j[r]}}}Expedition.fn.event._eventPriority(h,v)};Expedition.fn.event._keydownHandle=function(h){var c=Expedition.canvas._event,a=c.length,f,j,g=Expedition.fn.event.getTarget(h);for(var d=0;d<a;d++){if(c[d].type=="onkeydown"&&(c[d].id&&!Expedition.canvas[c[d].id].isHide||!c[d].id)){c[d].func(g)}}};Expedition.fn.event._keypressHandle=function(h){var c=Expedition.canvas._event,a=c.length,f,j,g=Expedition.fn.event.getTarget(h);for(var d=0;d<a;d++){if(c[d].type=="onkeypress"&&(c[d].id&&!Expedition.canvas[c[d].id].isHide||!c[d].id)){c[d].func(g)}}};Expedition.fn.event._keyupHandle=function(h){var c=Expedition.canvas._event,a=c.length,f,j,g=Expedition.fn.event.getTarget(h);for(var d=0;d<a;d++){if(c[d].type=="onkeyup"&&(c[d].id&&!Expedition.canvas[c[d].id].isHide||!c[d].id)){c[d].func(g)}}};Expedition.fn.event.draggable=function(n,m){var f=this.id,l=this._loop||[],j,h,g,s,c=true,d=m||{},t,r,q,p,o,a;r=function(w){var v=Expedition.fn.event.getPageX(w),u=Expedition.fn.event.getPageY(w);if(l.length>0){l[l.length-1].dragX=l[l.length-1].dragX||0;l[l.length-1].dragY=l[l.length-1].dragY||0;l[l.length-1].dragX+=v-p;l[l.length-1].dragY+=u-o}else{j=Expedition.fn.paint._getNewCanvas(f);h=j.getContext("2d");g=j.width;s=j.height;a=h.getImageData(0,0,g,s);h.clearRect(0,0,g,s);h.putImageData(a,v-p,u-o);Expedition.canvas[f]._x+=v;Expedition.canvas[f]._y+=u}p=v;o=u};q=function(u){Expedition.fn.un(document,"onmousemove",r)};t=function(u){p=Expedition.fn.event.getPageX(u);o=Expedition.fn.event.getPageY(u);Expedition.fn.on(document,"onmousemove",r);Expedition.fn.on(document,"onmouseup",q)};if(typeof(flag)=="object"){d=n}else{if(n===false){c=false}}if(c){$(f).mousedown(t,d)}else{$(f).removeEvent("mousedown");Expedition.fn.un(document,"onmouseup",q)}return this};Expedition.fn.event.getPageX=function(c){var a=c.pageX,d=document;if(!a&&a!==0){a=(c.clientX||0)+(d.documentElement.scrollLeft||d.body.scrollLeft)}return a};Expedition.fn.event.getPageY=function(c){var a=c.pageY,d=document;if(!a&&a!==0){a=(c.clientY||0)+(d.documentElement.scrollTop||d.body.scrollTop)}return a};Expedition.fn.event.stopPropagation=function(a){if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}};Expedition.fn.event.preventDefault=function(a){if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}};Expedition.fn.event.stop=function(a){var c=Expedition.fn.dom.event;c.stopPropagation(a);c.preventDefault(a)};Expedition.fn.event.getTarget=function(a){return a.target||a.srcElement};Expedition.fn.event.EventArg=function(d,g){g=g||window;d=d||g.event;var f=g.document;this.target=d.target||d.srcElement;this.keyCode=d.which||d.keyCode;for(var a in d){var c=d[a];if("function"!=typeof c){this[a]=c}}if(!this.pageX&&this.pageX!==0){this.pageX=(d.clientX||0)+(f.documentElement.scrollLeft||f.body.scrollLeft);this.pageY=(d.clientY||0)+(f.documentElement.scrollTop||f.body.scrollTop)}this._event=d};Expedition.fn.event.EventArg.prototype.preventDefault=function(){if(this._event.preventDefault){this._event.preventDefault()}else{this._event.returnValue=false}return this};Expedition.fn.event.EventArg.prototype.stopPropagation=function(){if(this._event.stopPropagation){this._event.stopPropagation()}else{this._event.cancelBubble=true}return this};Expedition.fn.event.EventArg.prototype.stop=function(){return this.stopPropagation().preventDefault()};Expedition.fn.event._unload=function(){var d=Expedition.fn.event._listeners,a=d.length,c=!!window.removeEventListener,g,f;while(a--){g=d[a];if(g[1]=="unload"){continue}f=g[0];if(f.removeEventListener){f.removeEventListener(g[1],g[3],false)}else{if(f.detachEvent){f.detachEvent("on"+g[1],g[3])}}}if(c){window.removeEventListener("unload",Expedition.fn.event._unload,false)}else{window.detachEvent("onunload",Expedition.fn.event._unload)}};if(window.attachEvent){window.attachEvent("onunload",Expedition.fn.event._unload)}else{window.addEventListener("unload",Expedition.fn.event._unload,false)}Expedition.fn.event._listeners=Expedition.fn.event._listeners||[];Expedition.fn.event.on=function(c,f,g){f=f.replace(/^on/i,"");c=Expedition.fn.dom._g(c);var d=function(h){g.call(c,h)},a=Expedition.fn.event._listeners;a[a.length]=[c,f,g,d];if(c.addEventListener){c.addEventListener(f,d,false)}else{if(c.attachEvent){c.attachEvent("on"+f,d)}}return c};Expedition.fn.on=Expedition.fn.event.on;Expedition.fn.event.get=function(a,c){return new Expedition.fn.event.EventArg(a,c)};Expedition.fn.event.un=function(d,f,h){d=Expedition.fn.dom._g(d);f=f.replace(/^on/i,"");var c=Expedition.fn.event._listeners,a=c.length,j=!h,g;while(a--){g=c[a];if(g[1]===f&&g[0]===d&&(j||g[2]===h)){if(d.removeEventListener){d.removeEventListener(f,g[3],false)}else{if(d.detachEvent){d.detachEvent("on"+f,g[3])}}c.splice(a,1)}}return d};Expedition.fn.un=Expedition.fn.event.un;Expedition.fn.event.getKeyCode=function(a){return a.which||a.keyCode};Expedition.fn.on(window,"onresize",function(){var c=document.getElementsByTagName("canvas"),a=c.length,f,g;for(var d=0;d<a;d++){f=c[d].getAttribute("BaseCanvas");if(f){g=Expedition.fn.dom.getPosition($().g(f));$().setStyles(c[d],{left:g.left+"px",top:g.top+"px"})}}});Expedition.fn.init.prototype={dispose:Expedition.fn.dispose,show:Expedition.fn.show,hide:Expedition.fn.hide,setIndex:Expedition.fn.paint.setIndex,dom:Expedition.fn.dom,g:Expedition.fn.g,setAttr:Expedition.fn.setAttr,setAttrs:Expedition.fn.setAttrs,getAttr:Expedition.fn.getAttr,trim:Expedition.fn.trim,addClass:Expedition.fn.addClass,removeClass:Expedition.fn.removeClass,setStyle:Expedition.fn.setStyle,setStyles:Expedition.fn.setStyles,q:Expedition.fn.q,getStyle:Expedition.fn.getStyle,inserHTML:Expedition.fn.inserHTML,on:Expedition.fn.event.on,un:Expedition.fn.event.un,extend:Expedition.fn.object.extend,each:Expedition.fn.object.each,keys:Expedition.fn.object.keys,values:Expedition.fn.object.values,clone:Expedition.fn.object.clone,browser:Expedition.fn._browser.getBrowser,isCanvasSupport:Expedition.fn._browser.isCanvasSupport,canvas:Expedition.fn.paint.canvas,size:Expedition.fn.paint.size,context:Expedition.fn.paint.context,setContext:Expedition.fn.paint._setContext,line:Expedition.fn.paint.line,rect:Expedition.fn.paint.rect,clearRect:Expedition.fn.paint.clearRect,fillRect:Expedition.fn.paint.fillRect,strokeRect:Expedition.fn.paint.strokeRect,arc:Expedition.fn.paint.arc,hypotrochoid:Expedition.fn.paint.hypotrochoid,epitrochoid:Expedition.fn.paint.epitrochoid,epicycloid:Expedition.fn.paint.epicycloid,hypocycloid:Expedition.fn.paint.hypocycloid,save:Expedition.fn.paint.save,restore:Expedition.fn.paint.restore,translate:Expedition.fn.paint.translate,beginPath:Expedition.fn.paint.beginPath,closePath:Expedition.fn.paint.closePath,fill:Expedition.fn.paint.fill,stroke:Expedition.fn.paint.stroke,clip:Expedition.fn.paint.clip,moveTo:Expedition.fn.paint.moveTo,lineTo:Expedition.fn.paint.lineTo,arcTo:Expedition.fn.paint.arcTo,bezierCurveTo:Expedition.fn.paint.bezierCurveTo,quadraticCurveTo:Expedition.fn.paint.quadraticCurveTo,customCurves:Expedition.fn.paint.customCurves,isPointInPath:Expedition.fn.paint.isPointInPath,addEvent:Expedition.fn.event._addEvent,removeEvent:Expedition.fn.event._removeEvent,dblclick:Expedition.fn.event.dblclick,click:Expedition.fn.event.click,contextmenu:Expedition.fn.event.contextmenu,mousedown:Expedition.fn.event.mousedown,mousemove:Expedition.fn.event.mousemove,mouseover:Expedition.fn.event.mouseover,mouseup:Expedition.fn.event.mouseup,keydown:Expedition.fn.event.keydown,keypress:Expedition.fn.event.keypress,keyup:Expedition.fn.event.keyup,touchstart:Expedition.fn.event.touchstart,touchmove:Expedition.fn.event.touchmove,touchend:Expedition.fn.event.touchend,draggable:Expedition.fn.event.draggable,isInObject:Expedition.fn.event._isInObject,spherical:Expedition.fn._lib.vector3d.spherical,transform2d:Expedition.fn._lib.vector3d.transform2d,heart:Expedition.fn.render.heart,flower:Expedition.fn.render.flower,ball:Expedition.fn.render.ball,stopBallLoop:Expedition.fn.render.stopBallLoop,cube:Expedition.fn.render.cube,stopCubeLoop:Expedition.fn.render.stopCubeLoop,burn:Expedition.fn.render.burn,stopBurn:Expedition.fn.render.stopBurn,getStrokeStyle:Expedition.fn.render.getStrokeStyle,setStrokeStyle:Expedition.fn.render.setStrokeStyle,getLineWidth:Expedition.fn.render.getLineWidth,setLineWidth:Expedition.fn.render.setLineWidth,getLineCap:Expedition.fn.render.getLineCap,setLineCap:Expedition.fn.render.setLineCap,getLineJoin:Expedition.fn.render.getLineJoin,setLineJoin:Expedition.fn.render.setLineJoin,getMiterLimit:Expedition.fn.render.getMiterLimit,setMiterLimit:Expedition.fn.render.setMiterLimit,getFillStyle:Expedition.fn.render.getFillStyle,setFillStyle:Expedition.fn.render.setFillStyle,getShadowBlur:Expedition.fn.render.getShadowBlur,setShadowBlur:Expedition.fn.render.setShadowBlur,getShadowColor:Expedition.fn.render.getShadowColor,setShadowColor:Expedition.fn.render.setShadowColor,getShadowOffsetX:Expedition.fn.render.getShadowOffsetX,setShadowOffsetX:Expedition.fn.render.setShadowOffsetX,getShadowOffsetY:Expedition.fn.render.getShadowOffsetY,setShadowOffsetY:Expedition.fn.render.setShadowOffsetY,getShadow:Expedition.fn.render.getShadow,setShadow:Expedition.fn.render.setShadow,getCompositeOperation:Expedition.fn.render.getCompositeOperation,setCompositeOperation:Expedition.fn.render.setCompositeOperation,rotate:Expedition.fn.render.rotate,scale:Expedition.fn.render.scale,createLinearGradient:Expedition.fn.render.createLinearGradient,createRadialGradient:Expedition.fn.render.createRadialGradient,addColorStop:Expedition.fn.render.addColorStop,getGradient:Expedition.fn.render.getGradient,randomRgba:Expedition.fn.render.randomRgba,drawImage:Expedition.fn.image.drawImage,createImageData:Expedition.fn.image.createImageData,getImageData:Expedition.fn.image.getImageData,putImageData:Expedition.fn.image.putImageData,imageAntiColor:Expedition.fn.image.imageAntiColor,imagePixelate:Expedition.fn.image.imagePixelate,imagePixelParticle:Expedition.fn.image.imagePixelParticle,imageGrey:Expedition.fn.image.imageGrey,imageMosaics:Expedition.fn.image.imageMosaics,imageFilterRed:Expedition.fn.image.imageFilterRed,imageFilterGreen:Expedition.fn.image.imageFilterGreen,imageFilterBlue:Expedition.fn.image.imageFilterBlue,imageBlockRed:Expedition.fn.image.imageBlockRed,imageBlockGreen:Expedition.fn.image.imageBlockGreen,imageBlockBlue:Expedition.fn.image.imageBlockBlue,imageTransparent:Expedition.fn.image.imageTransparent,backgroundImage:Expedition.fn.image.backgroundImage,closeBackgroundImage:Expedition.fn.image.closeBackgroundImage,drawInside:Expedition.fn.image.drawInside,drawOutside:Expedition.fn.image.drawOutside,drawVideo:Expedition.fn.video.drawVideo,stopVideo:Expedition.fn.video.stopVideo,videoAntiColor:Expedition.fn.video.videoAntiColor,stopVideoAntiColor:Expedition.fn.video.stopVideoAntiColor,videoGrey:Expedition.fn.video.videoGrey,stopVideoGrey:Expedition.fn.video.stopVideoGrey,videoFilterRed:Expedition.fn.video.videoFilterRed,stopVideoFilterRed:Expedition.fn.video.stopVideoFilterRed,videoFilterGreen:Expedition.fn.video.videoFilterGreen,stopVideoFilterGreen:Expedition.fn.video.stopVideoFilterGreen,videoFilterBlue:Expedition.fn.video.videoFilterBlue,stopVideoFilterBlue:Expedition.fn.video.stopVideoFilterBlue,videoBlockRed:Expedition.fn.video.videoBlockRed,stopVideoBlockRed:Expedition.fn.video.stopVideoBlockRed,videoBlockGreen:Expedition.fn.video.videoBlockGreen,stopVideoBlockGreen:Expedition.fn.video.stopVideoBlockGreen,videoBlockBlue:Expedition.fn.video.videoBlockBlue,stopVideoBlockBlue:Expedition.fn.video.stopVideoBlockBlue,videoTransparent:Expedition.fn.video.videoTransparent,stopVideoTransparent:Expedition.fn.video.stopVideoTransparent,videoPixelate:Expedition.fn.video.videoPixelate,stopVideoPixelate:Expedition.fn.video.stopVideoPixelate,videoPixelParticle:Expedition.fn.video.videoPixelParticle,stopVideoPixelParticle:Expedition.fn.video.stopVideoPixelParticle,videoMosaics:Expedition.fn.video.videoMosaics,stopVideoMosaics:Expedition.fn.video.stopVideoMosaics,backgroundVideo:Expedition.fn.video.backgroundVideo,closeBackgroundVideo:Expedition.fn.video.closeBackgroundVideo,getFont:Expedition.fn.text.getFont,setFont:Expedition.fn.text.setFont,getTextAlign:Expedition.fn.text.getTextAlign,setTextAlign:Expedition.fn.text.setTextAlign,getTextBaseline:Expedition.fn.text.getTextBaseline,setTextBaseline:Expedition.fn.text.setTextBaseline,fillText:Expedition.fn.text.fillText,strokeText:Expedition.fn.text.strokeText,measureText:Expedition.fn.text.measureText,write:Expedition.fn.text.write,addMove:Expedition.fn.move.addMove,pauseMove:Expedition.fn.move.pauseMove,runMove:Expedition.fn.move.runMove,cancelMove:Expedition.fn.move.cancelMove,uniLinMotion:Expedition.fn.move.uniLinMotion,accLinMotion:Expedition.fn.move.accLinMotion,cirMotion:Expedition.fn.move.cirMotion,parMotion:Expedition.fn.move.parMotion,sinMotion:Expedition.fn.move.sinMotion,hypMotion:Expedition.fn.move.hypMotion,epiMotion:Expedition.fn.move.epiMotion,htpocycMotion:Expedition.fn.move.htpocycMotion,epicycMotion:Expedition.fn.move.epicycMotion,startQueue:Expedition.fn.queue.startQueue,stopQueue:Expedition.fn.queue.stopQueue,expand:Expedition.fn.expand};